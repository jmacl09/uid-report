/* === UID TOP GRID: Summary | Search | Status (responsive) === */
.uid-top-grid {
  display: grid;
  grid-template-areas: "summary search status";
  grid-template-columns: minmax(280px, 340px) 1fr minmax(280px, 320px);
  column-gap: 1rem;
  align-items: start;
  margin-bottom: 1rem;
}
.uid-top-grid .summary-panel { grid-area: summary; }
.uid-top-grid .status-panel { grid-area: status; }
.uid-top-search {
  grid-area: search;
  display: inline-flex;
  align-items: center;
  gap: 8px;
  justify-self: center; /* keep centered on wide screens */
}

/* When width starts to be tight, keep summary and status side-by-side, move search below */
@media (max-width: 1100px) {
  .uid-top-grid {
    grid-template-areas:
      "summary . status"
      "search search search";
    grid-template-columns: minmax(260px, 1fr) 1fr minmax(260px, 1fr);
    row-gap: 0.75rem;
  }
  .uid-top-search { justify-self: center; }
}

/* Small screens: stack all three vertically, keeping search between summary and status */
@media (max-width: 768px) {
  .uid-top-grid {
    grid-template-areas:
      "summary"
      "search"
      "status";
    grid-template-columns: 1fr;
  }
  .uid-top-grid .panel { min-width: 0; }
}
/* === GLOBAL === */
body {
  font-family: "Segoe UI", sans-serif;
  background-color: #0b0b0b;
  color: #ddd;
  margin: 0;
  overflow-x: hidden;
}

/* === GLOBAL COOL DARK GLOWY SCROLLBARS === */
/* Cross‑browser polished scrollbars that match the app's neon/dark theme */
:root {
  --sb-size: 10px;
  --sb-track: #0c1118;
  --sb-track-glow: rgba(80, 179, 255, 0.06);
    --sb-thumb: #4b8fd8;
    --sb-thumb-2: #23537a;
    --sb-thumb-border: rgba(80, 179, 255, 0.35);
    --sb-thumb-hover: #3a74b8;
    --sb-thumb-hover-2: #1a4160;
    --vso-input-bg: #141414;
    --vso-input-border: #333333;
    --vso-input-text: #e6f6ff;
    --vso-dropdown-bg: #141414;
    --vso-dropdown-item-hover-bg: #225b8a;
    --vso-dropdown-item-selected-bg: #003b6f;
    --vso-dropdown-text: #ffffff;
    --vso-label-color: #cccccc;
    --vso-label-subtle: #9fb3c6;
    --capacity-inner-bg: linear-gradient(180deg, rgba(7,20,36,0.98), rgba(0,16,22,0.95));
    --capacity-inner-shadow: inset 0 -6px 18px rgba(0,0,0,0.6);
    --fiber-tooltip-bg: #071821;
    --fiber-tooltip-color: #ffffff;
    --fiber-tooltip-subtle: #e6f1ff;
}

/* Firefox */
/* Make scrollbars thin, with themed colors; element-level rules below will inherit. */
html, body, .main, .table-container, .projects-rail-list, .notes-list, .ms-Callout-main, .ms-ComboBox-optionsContainer, .ms-Dropdown-items {
  scrollbar-width: thin;
  scrollbar-color: var(--sb-thumb) var(--sb-track);
}

/* WebKit (Chrome, Edge, Safari) */
*::-webkit-scrollbar {
  width: var(--sb-size);
  height: var(--sb-size);
}
*::-webkit-scrollbar-track {
  background: linear-gradient(180deg, rgba(12,17,24,0.95), rgba(10,14,20,0.95));
  border-radius: 12px;
  box-shadow: inset 0 0 8px var(--sb-track-glow);
}
*::-webkit-scrollbar-thumb {
  background: linear-gradient(180deg, var(--sb-thumb), var(--sb-thumb-2));
  border-radius: 12px;
  border: 1px solid var(--sb-thumb-border);
  box-shadow: 0 0 10px rgba(80,179,255,0.22), inset 0 0 8px rgba(255,255,255,0.06);
  min-height: 28px;
}
*::-webkit-scrollbar-thumb:hover {
  background: linear-gradient(180deg, var(--sb-thumb-hover), var(--sb-thumb-hover-2));
  box-shadow: 0 0 12px rgba(80,179,255,0.35), inset 0 0 8px rgba(255,255,255,0.08);
}
*::-webkit-scrollbar-thumb:active {
  background: linear-gradient(180deg, var(--sb-thumb-active), var(--sb-thumb-active-2));
  box-shadow: 0 0 14px rgba(80,179,255,0.42), inset 0 0 10px rgba(255,255,255,0.10);
}
*::-webkit-scrollbar-corner { background: transparent; }

/* Slightly inset scrollbars inside table containers and callouts for a refined look */
.table-container::-webkit-scrollbar-track,
.projects-rail-list::-webkit-scrollbar-track,
.notes-list::-webkit-scrollbar-track,
.combo-dark-callout .ms-Callout-main::-webkit-scrollbar-track,
.combo-dark-callout .ms-ComboBox-optionsContainer::-webkit-scrollbar-track,
.ms-Dropdown-items::-webkit-scrollbar-track {
  background: linear-gradient(180deg, rgba(12,17,24,0.9), rgba(9,13,19,0.92));
}

/* Do not override the explicit dialog scrollbar-hiding rules already present below. */

/* === MAIN CONTAINER === */
.vso-form-container {
  background: radial-gradient(circle at top, #0d0d0d 0%, #000 100%);
  border-radius: 14px;
  padding: 40px 60px 50px;
  box-shadow: 0 0 25px rgba(0, 140, 255, 0.25), inset 0 0 8px rgba(255, 255, 255, 0.05);
  text-align: left;
  margin: 50px auto;
  position: relative;
  overflow: hidden;
}

/* === BANNER TITLE === */
.banner-title {
  text-align: center;
  color: #e8f2fb;
  background: linear-gradient(180deg, #0d2230 0%, #0b1b28 100%);
  padding: 14px 12px 12px;
  border-radius: 10px;
  margin: 0 auto 22px;
  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.35);
  border: 1px solid rgba(80, 160, 220, 0.18);
  width: 100%;
  max-width: 780px;
  box-sizing: border-box;
  position: relative;
  overflow: hidden;
}

.banner-title .title-text {
  display: block;
  font-size: 26px;
  font-weight: 750;
  letter-spacing: 0.4px;
  background: linear-gradient(90deg, #bfe8ff, #50b3ff, #a8d7ff);
  background-size: 200% 100%;
  -webkit-background-clip: text;
  background-clip: text;
  -webkit-text-fill-color: transparent;
  text-shadow: 0 0 10px rgba(80, 179, 255, 0.6), 0 0 22px rgba(0, 120, 212, 0.45);
  animation: titleGlowShift 8s linear infinite, neonPulse 4s ease-in-out infinite;
}

/* Underline glow accent */
.banner-title .title-text::after {
  content: "";
  display: block;
  width: 160px;
  height: 2px;
  margin: 8px auto 0;
  border-radius: 999px;
  background: radial-gradient(circle, rgba(80,179,255,0.9) 0%, rgba(80,179,255,0.35) 40%, transparent 70%);
  box-shadow: 0 0 10px rgba(80,179,255,0.6), 0 0 18px rgba(0,120,212,0.45);
  animation: underlinePulse 3.5s ease-in-out infinite;
}

/* Subtle animated sheen across the banner */
.banner-title::after {
  content: "";
  position: absolute;
  top: -40%;
  left: -60%;
  width: 40%;
  height: 180%;
  background: linear-gradient(90deg, transparent, rgba(255,255,255,0.14), transparent);
  filter: blur(3px);
  transform: rotate(20deg) translateX(0%);
  animation: sheenSweep 7s ease-in-out infinite;
  pointer-events: none;
}

/* Inner glow rim for extra depth */
.banner-title::before {
  content: "";
  position: absolute;
  inset: 0;
  border-radius: inherit;
  box-shadow: inset 0 0 22px rgba(0, 120, 212, 0.25), 0 0 20px rgba(0, 120, 212, 0.15);
  pointer-events: none;
}

.banner-title:hover {
  box-shadow: 0 0 16px rgba(0, 120, 212, 0.5), 0 0 26px rgba(0, 120, 212, 0.35);
}

.banner-title .title-sub {
  display: block;
  margin-top: 2px;
  font-size: 12px;
  font-weight: 500;
  color: #a6b7c6;
  opacity: 0.9;
  letter-spacing: 0.2px;
}

/* === FIELD SPACING FIX (unified gaps) === */
.vso-form-container .ms-TextField,
.vso-form-container .ms-Dropdown,
.vso-form-container .ms-ComboBox {
  margin-top: 10px;
  margin-bottom: 20px; /* consistent separation between controls */
}

/* Fix cut-off input issue */
.ms-TextField-fieldGroup,
.ms-Dropdown-title {
  border: 1px solid #333 !important;
  border-radius: 8px !important;
  height: 44px !important;
  align-items: center !important;
  display: flex !important;
}

/* Prevent extra focus/hover outlines that look like double borders */
.ms-TextField-fieldGroup,
.ms-Dropdown-title {
  box-shadow: none !important;
}
.ms-TextField-fieldGroup::after,
.ms-Dropdown-title::after {
  border: none !important;
  box-shadow: none !important;
}

.ms-TextField-field {
  padding-top: 2px !important;
  padding-bottom: 2px !important;
  background: transparent !important;
  border: none !important;
}

/* === BUTTONS === */
.submit-btn {
  background: linear-gradient(90deg, #0078d4, #00aaff);
  color: white;
  border: none;
  border-radius: 6px;
  padding: 10px 26px;
  font-weight: 600;
  font-size: 14px;
  cursor: pointer;
  transition: all 0.2s ease-in-out;
}

.submit-btn:hover {
  background: linear-gradient(90deg, #00aaff, #0078d4);
  transform: translateY(-1px);
}

.help-btn {
  background: #ff4444;
  color: white;
  border: none;
  border-radius: 6px;
  padding: 10px 26px;
  font-weight: 600;
  font-size: 14px;
  margin-left: 8px;
  cursor: pointer;
  transition: all 0.2s ease-in-out;
}

.help-btn:hover {
  background: #ff6666;
  transform: translateY(-1px);
}

/* === DISCLAIMER AND FOOTER === */
.disclaimer {
  color: #999;
  font-size: 12px;
  margin-top: 16px;
}

.developer {
  color: #aaa;
  font-size: 12px;
  margin-top: 6px;
  line-height: 1.5;
}

.developer a {
  color: #4da6ff;
  text-decoration: none;
}

.developer a:hover {
  text-decoration: underline;
}

/* === GLOW === */
.glow {
  box-shadow: 0 0 30px rgba(0, 153, 255, 0.25);
}

/* === RESPONSIVE === */
@media (max-width: 768px) {
  .vso-form-container {
    padding: 30px 24px;
  }

  .banner-title {
    padding: 10px 10px 10px;
  }
  .banner-title .title-text {
    font-size: 20px;
  }
  .banner-title .title-sub {
    font-size: 12px;
  }
}

/* === Title Animations === */
@keyframes titleGlowShift {
  0% { background-position: 0% 50%; }
  100% { background-position: 200% 50%; }
}

@keyframes neonPulse {
  0%, 100% {
    text-shadow: 0 0 10px rgba(80,179,255,0.55), 0 0 22px rgba(0,120,212,0.45);
  }
  50% {
    text-shadow: 0 0 16px rgba(80,179,255,0.9), 0 0 30px rgba(0,120,212,0.75);
  }
}

@keyframes underlinePulse {
  0%, 100% {
    transform: scaleX(0.95);
    opacity: 0.8;
  }
  50% {
    transform: scaleX(1);
    opacity: 1;
  }
}

@keyframes sheenSweep {
  0% {
    transform: rotate(20deg) translateX(0%);
    opacity: 0;
  }
  10% { opacity: 0.4; }
  50% {
    transform: rotate(20deg) translateX(260%);
    opacity: 0.9;
  }
  60% { opacity: 0; }
  100% {
    transform: rotate(20deg) translateX(260%);
    opacity: 0;
  }
}

/* === SIDEBAR === */
.sidebar {
  width: 240px;
  background: #0a0a0a;
  padding: 20px 16px;
  display: flex;
  flex-direction: column;
  height: 100vh;
  box-sizing: border-box;
  box-shadow: 2px 0 10px rgba(0, 0, 0, 0.6);
  position: fixed;
  left: 0;
  top: 0;
}

.dark-nav .ms-Nav-linkText {
  color: #ccc !important;
  font-weight: 500;
}

.dark-nav .ms-Nav-link {
  background: transparent !important;
  color: #ccc !important;
  border-radius: 6px;
  padding: 6px 10px;
  transition: all 0.25s ease-in-out;
}

.dark-nav .ms-Nav-link:hover {
  background: #0078d4 !important;
  color: #fff !important;
  box-shadow: 0 0 10px rgba(0, 120, 212, 0.7);
}

/* ✅ Active link glow */
.dark-nav .ms-Nav-compositeLink.is-selected .ms-Nav-link {
  background-color: #0078d4 !important;
  color: #fff !important;
  box-shadow: 0 0 14px rgba(0, 120, 212, 0.8);
}

/* === LOGO === */
.logo-img {
  width: 160px;
  margin: 0 auto 24px;
  display: block;
  filter: drop-shadow(0 0 10px #50b3ff);
  transition: all 0.25s ease-in-out;
}
.logo-img:hover {
  transform: scale(1.05);
  filter: drop-shadow(0 0 18px #50b3ff);
}

/* === FOOTER === */
.footer {
  color: #999 !important;
  margin-top: auto;
  text-align: center;
  border-top: 1px solid #222;
  padding-top: 8px;
  font-size: 12px;
}

/* User status in sticky row (top-right within scrolling main content) */
.user-status-sticky-row {
  position: sticky;
  top: 0;
  z-index: 12000; /* keep above main content */
  display: flex;
  justify-content: flex-end;
  padding: 12px 28px 0 0; /* vertical offset + right spacing */
  background: transparent;
  pointer-events: none; /* let child control interaction */
}
.user-status {
  display: flex;
  align-items: center;
  gap: 8px;
  background: transparent;
  pointer-events: auto; /* allow interaction */
}
.user-avatar {
  width: 36px;
  height: 36px;
  border-radius: 999px;
  background: linear-gradient(180deg, #1a1a1a, #0f0f0f);
  border: 1px solid rgba(80,140,200,0.12);
  color: #dfefff;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  padding: 6px; /* give room for SVG */
  box-shadow: 0 4px 14px rgba(0,120,212,0.08), 0 0 0 4px rgba(0,120,212,0.03), 0 0 18px rgba(0,120,212,0.14);
  transition: box-shadow 220ms ease, transform 180ms ease;
}
.user-email {
  color: #dfefff;
  font-size: 13px;
  max-width: 260px;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

/* UID compact search styling (details page) */
.uid-compact-bar {
  margin: 8px 0 14px;
  display: flex;
  justify-content: center;
}
.uid-compact-bar .compact-card {
  display: flex;
  gap: 12px;
  align-items: center;
  padding: 10px 14px;
  border-radius: 12px;
  background: linear-gradient(180deg, rgba(16,18,20,0.92), rgba(10,10,12,0.96));
  border: 1px solid rgba(80,140,200,0.06);
  box-shadow: 0 8px 30px rgba(0,0,0,0.6), inset 0 0 8px rgba(255,255,255,0.01);
  min-width: 420px;
  max-width: 880px;
  width: 90%;
}
.uid-compact-bar .compact-card .input-field {
  flex: 1 1 auto;
  margin: 0;
}
.uid-compact-bar .compact-card .ms-TextField-fieldGroup {
  width: 100% !important;
  min-width: 220px;
  height: 42px !important;
  border-radius: 8px !important;
  border: 1px solid #2b2b2b !important;
  background: #0f0f0f !important;
}
.uid-compact-bar .compact-card .search-btn,
.uid-compact-bar .compact-card .sleek-btn {
  padding: 8px 16px;
  border-radius: 8px;
  min-width: 100px;
}
@media (max-width: 640px) {
  .uid-compact-bar .compact-card { flex-direction: column; gap: 8px; padding: 8px; width: 96%; }
  .uid-compact-bar .compact-card .search-btn { width: 100%; }
}

/* Compose date/time row helpers */
.compose-datetime-row {
  display: grid;
  /* group Start Date + Start Time, then End Date + End Time, then actions */
  grid-template-columns: minmax(260px, 1fr) 120px minmax(260px, 1fr) 120px auto;
  column-gap: 12px;
  row-gap: 12px;
  align-items: end;
  width: 100%;
  margin-top: 12px;
}
.compose-datetime-row .dt-field,
.compose-datetime-row .dt-time {
  display: flex;
  flex-direction: column;
  gap: 6px;
}
.compose-datetime-row .dt-actions {
  display: inline-flex;
  gap: 8px;
  align-items: flex-end;
  justify-content: flex-end;
}

@media (max-width: 960px) {
  .compose-datetime-row {
    grid-template-columns: minmax(220px, 1fr) minmax(160px, 1fr);
  }
  .compose-datetime-row .dt-actions {
    justify-content: flex-start;
  }
}

/* Make Add/Remove window buttons stand out on dark background */
.tiny-icon-btn {
  width: 32px;
  height: 32px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  padding: 0;
  border-radius: 999px; /* circular */
  background: transparent;
  color: #fff;
  border: 1px solid rgba(255,255,255,0.08);
  font-size: 15px;
  line-height: 1;
  cursor: pointer;
  transition: transform 120ms ease, background 120ms ease, box-shadow 120ms ease;
}
.tiny-icon-btn:hover {
  transform: translateY(-2px);
  background: rgba(255,255,255,0.02);
}
.tiny-icon-btn:focus {
  outline: none;
  box-shadow: 0 0 0 3px rgba(80,160,255,0.12);
}
.add-window-btn.tiny-icon-btn {
  border-color: rgba(80,180,255,0.18);
}
.remove-window-btn.tiny-icon-btn {
  border-color: rgba(255,110,110,0.14);
}

/* make the plus/minus glyph slightly larger and vertically centered */
.tiny-icon-btn .glyph {
  font-weight: 700;
  font-size: 16px;
}

/* Hide Fluent UI default inline error messages so we control when they show */
.vso-form-container .ms-TextField-errorMessage,
.vso-form-container .ms-Dropdown-errorMessage,
.vso-form-container .ms-DatePicker .ms-TextField .ms-TextField-errorMessage {
  display: none !important;
}

@media (max-width: 640px) {
  .compose-datetime-row .dt-time { width: 120px; flex: 0 0 120px; }
}

/* === MAIN LAYOUT === */
.main {
  flex-grow: 1;
  padding: 40px 30px 30px 260px;
  overflow-y: auto;
  min-height: 100vh;
  box-sizing: border-box;
}

/* === SEARCH AREA === */
.input-field .ms-TextField-fieldGroup {
  width: 220px;
  border: 1px solid #50b3ff;
  border-radius: 8px;
  background: #141414;
}
.input-field input {
  color: #fff;
}

.search-btn {
  background: #0078d4 !important;
  border-radius: 8px;
  transition: all 0.15s ease-in-out;
  /* Make the search button visually centered and same height as input */
  height: 42px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  padding: 0 16px;
}
.search-btn:hover {
  background: #106ebe !important;
  box-shadow: 0 0 10px #0078d4;
}

/* Inline UID validation error under search box */
.uid-inline-error {
  margin-top: 4px;
  font-size: 12px;
  color: #ffb3b3; /* soft red */
  background: rgba(214, 55, 55, 0.08);
  border: 1px solid rgba(214, 55, 55, 0.25);
  border-radius: 8px;
  padding: 6px 8px;
  box-shadow: inset 0 0 8px rgba(255,255,255,0.02);
}

/* Centered projects toolbar layout: [left spacer] [centered search] [right controls] */
.projects-toolbar {
  display: grid;
  grid-template-columns: 1fr auto 1fr;
  align-items: center;
  gap: 8px;
  margin-bottom: 8px;
}
.projects-toolbar .toolbar-center { justify-self: center; }
.projects-toolbar .toolbar-right { justify-self: end; display: flex; gap: 8px; align-items: center; flex-wrap: wrap; }
@media (max-width: 700px) {
  .projects-toolbar { grid-template-columns: 1fr; row-gap: 8px; }
  .projects-toolbar .toolbar-center { justify-self: center; }
  .projects-toolbar .toolbar-right { justify-self: center; }
}

/* Project UIDs box (shown when viewing a saved project with multiple UIDs) */
.project-uids-box {
  background: radial-gradient(circle at 25% 20%, #161616, #0f0f0f);
  border: 1px solid #2b2b2b;
  border-radius: 10px;
  box-shadow: 0 0 12px rgba(0,0,0,0.5), inset 0 0 6px rgba(255,255,255,0.03);
  padding: 8px 10px;
  margin-bottom: 10px;
}
.project-uids-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 10px;
}
.project-uids-title {
  color: #50b3ff;
  font-weight: 800;
  font-size: 13px;
  letter-spacing: 0.4px;
}
.project-uids-chips {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
  margin-top: 6px;
}
.uid-chip {
  display: inline-flex;
  align-items: center;
  padding: 4px 10px;
  border-radius: 999px;
  background: linear-gradient(90deg, #0f2030, #0c1826);
  border: 1px solid rgba(80,160,220,0.28);
  color: #dfefff;
  font-size: 12px;
  font-weight: 700;
  cursor: pointer;
  box-shadow: 0 2px 8px rgba(0,0,0,0.45), inset 0 0 6px rgba(255,255,255,0.03);
  transition: transform 120ms ease, box-shadow 120ms ease;
}
.uid-chip:hover {
  transform: translateY(-1px);
  box-shadow: 0 3px 10px rgba(0,0,0,0.55), 0 0 10px rgba(80,179,255,0.2);
}

/* === TABLES === */
 .table-container {
  background: #181818;
  border-radius: 10px;
  padding: 10px 12px;
  border: 1px solid #2b2b2b;
  margin-bottom: 18px;
  box-shadow: 0 0 8px rgba(0, 0, 0, 0.6);
  width: 100%;
  overflow-x: auto; /* allow horizontal scroll if needed */
  /* prevent table containers from stretching vertically in flex parents */
  flex: 0 1 auto; /* allow shrinking/growing horizontally but keep natural height */
  align-self: flex-start; /* avoid being stretched to match sibling heights */
  min-width: 0; /* allow flex children to shrink without overflow */
  box-sizing: border-box;
}

.section-title {
  color: #50b3ff;
  font-weight: 700;
  border-left: 4px solid #50b3ff;
  padding-left: 8px;
  margin-bottom: 6px;
  text-shadow: 0 0 6px rgba(80, 179, 255, 0.6);
}

.data-table {
  border-collapse: collapse;
  margin-top: 6px;
  font-size: 13px;
  /* make the table bleed to the edges of the container so row separators span full width */
  width: calc(100% + 24px);
  margin-left: -12px; /* compensate for .table-container horizontal padding (12px each side) */
}

/* Specific tweak: Details and Link Summary often have very few rows — keep them compact */
.table-container.details-fit,
.table-container .details-table {
  margin-bottom: 8px; /* reduce extra gap for compact sections */
}
/* Specific override: remove the horizontal divider under Details table headers.
   Inline styles on the table weren't enough because global row separators are
   drawn on tbody rows. Target the details-table specifically and disable the
   row separators and any header bottom borders with strong specificity. */
.table-container .details-table thead th {
  border-bottom: none !important;
}
.table-container .details-table tbody tr {
  border-bottom: none !important;
}
.table-container.details-fit .data-table thead th {
  border-bottom: none !important;
}
.data-table thead tr {
  background: linear-gradient(90deg, #0078d4, #005a9e);
}
.data-table th {
  color: white;
  font-weight: 600;
  padding: 7px 12px;
  text-align: left;
  white-space: nowrap;
  cursor: pointer;
  position: relative;
  transition: background 0.2s ease-in-out;
}
.data-table th:hover {
  background: #0a64ad;
}
.data-table td {
  /* remove per-cell bottom borders so we can draw a continuous row border across the container */
  border-bottom: none;
  padding: 6px 12px;
  color: #eee;
  white-space: nowrap; /* prevent wrapping */
  overflow: hidden; /* clip long content and avoid overlap */
  text-overflow: ellipsis; /* show trailing dots for clipped content */
}

/* Draw the horizontal separators on the table rows instead so the line is continuous
   left-to-right across the container (table is bleeded to container edges above). */
.data-table tbody tr {
  border-bottom: 1px solid #2b2b2b;
}
.data-table tbody tr:last-child {
  border-bottom: none;
}
.data-table tr:nth-child(even) {
  background: #151515;
}
/* Theme-aware data row backgrounds: prefer CSS variables so light theme can override
   Use the `.data-row` class so component logic can avoid inline background styles. */
.data-table tbody tr.data-row {
  background: var(--vso-row-bg, #0f0f0f);
}
.data-table tbody tr.data-row:nth-child(even) {
  background: var(--vso-row-bg-even, #121212);
}
.data-table tbody tr.data-row:nth-child(odd) {
  background: var(--vso-row-bg-odd, #0f0f0f);
}

/* Light-theme overrides for data rows */
.light-theme .data-table tbody tr.data-row:nth-child(even) {
  background: #f3f4f6;
}
.light-theme .data-table tbody tr.data-row:nth-child(odd) {
  background: #ffffff;
}

/* Highlighted (selected) row in light theme */
.light-theme .highlight-row {
  background: #e6f4ff !important;
  box-shadow: none !important;
  border-bottom: 1px solid #e6f4ff !important;
}

/* Spans summary box used in VSO assistant */
.spans-summary {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  padding: 6px 10px;
  background: linear-gradient(180deg, rgba(3,18,22,0.95), rgba(6,26,32,0.9));
  border: 1px solid rgba(80,140,180,0.06);
  box-shadow: 0 6px 16px rgba(2,12,16,0.55), inset 0 1px 0 rgba(255,255,255,0.01);
  border-radius: 10px;
  color: #d9f3fb;
  transition: transform 120ms ease, background 120ms ease, color 120ms ease, box-shadow 120ms ease;
  position: relative;
}

.spans-summary .spans-count {
  font-weight: 700;
  font-size: 16px;
  color: #e6fbff;
  letter-spacing: -0.2px;
}

.spans-summary .spans-sub {
  font-size: 11px;
  color: #98b4bd;
}

/* Smaller compact production badge that shares the same base background as Total */
.spans-summary .spans-count.production {
  /* use same dark base as total but with a subtle green tint and brighter green text */
  background: linear-gradient(180deg, rgba(6,40,56,0.85), rgba(6,34,46,0.85));
  color: #00e676; /* brighter green */
  border: 1px solid rgba(0,230,118,0.12);
  box-shadow: 0 6px 12px rgba(0,230,118,0.06) inset;
  padding: 4px 8px;
  border-radius: 6px;
  font-size: 14px;
  font-weight: 800;
}

/* Add a subtle accent stripe on the left using a pseudo-element */
.spans-summary::before {
  content: '';
  position: absolute;
  left: 0;
  top: 6px;
  bottom: 6px;
  width: 6px;
  border-top-left-radius: 12px;
  border-bottom-left-radius: 12px;
  background: linear-gradient(180deg, #00a8ff, #0066cc);
  box-shadow: 0 4px 12px rgba(0,110,200,0.18);
}

/* Production badge: green pill to denote in-production count */
.spans-summary .spans-count.production {
  /* override duplicate rules: keep compact, bright, and consistent */
  background: linear-gradient(180deg, rgba(6,40,56,0.85), rgba(6,34,46,0.85));
  color: #00e676;
  border: 1px solid rgba(0,230,118,0.12);
  box-shadow: 0 6px 12px rgba(0,230,118,0.06) inset;
  padding: 4px 8px;
  border-radius: 6px;
  font-size: 14px;
  font-weight: 800;
}

/* Total count accent style */
.spans-summary .spans-count:first-child {
  font-size: 18px;
  color: #e6fbff;
  text-shadow: none;
}

/* Divider between total and production blocks */
.spans-summary > div + div {
  padding-left: 14px;
  border-left: 1px solid rgba(255,255,255,0.04);
}

/* Responsive: stack vertically on narrow widths */
@media (max-width: 520px) {
  .spans-summary {
    display: inline-flex;
    flex-direction: column;
    align-items: flex-start;
    gap: 6px;
    padding: 10px 12px 12px 12px;
  }
  .spans-summary::before { left: 8px; top: 8px; bottom: auto; height: 6px; width: calc(100% - 16px); border-radius: 6px; }
  .spans-summary > div + div { border-left: none; padding-left: 0; }
}

/* Make each count block the same size and style them with subtle colored backgrounds */
.spans-summary > div {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  width: 84px; /* smaller fixed width so both blocks match and appear compact */
  min-width: 72px;
  gap: 6px;
}

.spans-summary .spans-count,
.spans-summary .spans-count.production {
  width: 100%;
  height: 36px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 8px;
  padding: 4px 6px;
}

/* Slight bluish background for the total spans box (non-production) */
.spans-summary .spans-count:not(.production) {
  background: linear-gradient(180deg, rgba(6,40,56,0.85), rgba(6,34,46,0.85));
  border: 1px solid rgba(0,120,180,0.06);
  color: #e6fbff;
  box-shadow: inset 0 -2px 6px rgba(0,0,0,0.35);
}

/* Ensure production badge remains green and matches size/style */
.spans-summary .spans-count.production {
  background: linear-gradient(180deg, #e6fff0, #d3ffea);
  color: #064e2a;
  border: 1px solid rgba(34,197,94,0.18);
  box-shadow: 0 4px 10px rgba(6,80,36,0.06) inset;
}

@media (max-width: 520px) {
  .spans-summary > div { width: 100%; }
  .spans-summary .spans-count,
  .spans-summary .spans-count.production { height: 56px; }
}

/* Light theme overrides for spans summary */
.light-theme .spans-summary {
  background: #ffffff;
  border: 1px solid #e6eef2;
  box-shadow: 0 1px 6px rgba(15,23,42,0.06);
  color: #0b1220;
}
.light-theme .spans-summary .spans-count {
  color: #0b1220;
}
.light-theme .spans-summary .spans-sub {
  color: #475569;
}
.light-theme .spans-summary .spans-count.production {
  background: #f1f5f9;
  border: 1px solid #e6eef2;
}

/* Light-theme: make Fluent UI Toggle (Detailed view) match light visuals */
.light-theme .ms-Toggle {
  color: var(--text-1);
}
.light-theme .ms-Toggle .ms-Toggle-label {
  color: var(--text-1);
}
.light-theme .ms-Toggle .ms-Toggle-background {
  background: #e9f1fb; /* light neutral track */
  border: 1px solid #d6e7f8;
}
.light-theme .ms-Toggle .ms-Toggle-thumb {
  background: #ffffff;
  border: 1px solid #cbdff4;
  box-shadow: none;
}
.light-theme .ms-Toggle.is-checked .ms-Toggle-background {
  background: var(--accent) !important; /* accent color when on */
  border-color: var(--accent) !important;
}
.light-theme .ms-Toggle.is-checked .ms-Toggle-thumb {
  background: #ffffff !important;
  border-color: rgba(255,255,255,0.5) !important;
}
.light-theme .ms-Toggle .ms-Toggle-stateText {
  color: #0b1220 !important;
}

/* Make the two count tiles light and readable in light theme */
.light-theme .spans-summary .spans-count:not(.production) {
  background: #ffffff !important;
  border: 1px solid #e6eef2 !important;
  color: var(--text-1) !important;
  box-shadow: none !important;
}
.light-theme .spans-summary .spans-count {
  background-clip: padding-box !important;
}

/* Stronger light-theme color enforcement for spans count to ensure readability */
.light-theme .spans-summary .spans-count {
  color: var(--text-1) !important; /* primary dark text for light theme */
}
.light-theme .spans-summary .spans-count:first-child {
  color: var(--text-1) !important;
}
.light-theme .spans-summary .spans-count.production {
  color: #064e2a !important; /* dark green for production badge on light bg */
}

/* Light theme for the red/danger status pill (Diversity) */
.light-theme .status-label.danger {
  background: #fff1f2;
  color: #7f1d1d;
  border-color: #fecaca;
  box-shadow: none;
}

/* Optional small divider between the total and in-production blocks */
.spans-summary > div + div {
  padding-left: 12px;
  border-left: 1px solid rgba(255,255,255,0.04);
}

.light-theme .spans-summary > div + div {
  border-left: 1px solid rgba(15,23,42,0.04);
  padding-left: 12px;
}
/* Paint the hover background on the entire row element to avoid visual seams
   between adjacent cells (e.g., between the checkbox column and the first data
   column). Make cell backgrounds transparent so the row background shows
   continuously. */
.data-table tbody tr:hover {
  background: #232323 !important;
}
.data-table tbody tr:hover td {
  background: transparent !important;
}
.highlight-row {
  background: #003b3b !important;
  box-shadow: inset 0 0 10px rgba(0, 130, 114, 0.8);
  /* Make the separator line match the highlight so no visible gap appears */
  border-bottom: 1px solid #003b3b !important;
}

/* Ensure highlighted rows cover the full width and their cells don't show the underlying
   separator color — inherit the row background and remove cell-level borders */
.data-table tbody tr.highlight-row td {
  background: transparent !important;
  border-bottom: none !important;
}

/* Equal-height helper for side-by-side tables */
.equal-tables-row {
  display: flex;
  gap: 20px;
  align-items: stretch; /* stretch children to the tallest */
  width: 100%;
}
.equal-tables-row .table-container {
  flex: 1 1 0; /* make both containers share width */
  align-self: stretch !important; /* override default flex-start */
  display: flex; /* allow internal content to flow top-to-bottom */
  flex-direction: column;
}
/* The table itself can remain natural height; the container will stretch to match row height,
   leaving tasteful blank space to keep symmetry */

/* Compact Table Style */
.data-table.compact th,
.data-table.compact td {
  padding: 5px 10px;
  font-size: 12px;
}

/* Very dense Link Summary variant: reduce paddings, font-size and tighten inputs so the table is compact
   Applies only to the Link Summary table via .compact-link-summary class added by component. */
.data-table.compact-link-summary {
  table-layout: fixed; /* keep columns stable */
  width: 100%;
  margin-left: 0; /* avoid bleed for compact layout */
}
.data-table.compact-link-summary thead tr { background: linear-gradient(90deg, #005f9a, #004a7a); }
.data-table.compact-link-summary th,
.data-table.compact-link-summary td {
  padding: 4px 6px !important;
  font-size: 12px !important;
  line-height: 16px !important;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}
.data-table.compact-link-summary td { color: #e8f4ff; }
.data-table.compact-link-summary tbody tr { border-bottom: 1px solid #222; }
.data-table.compact-link-summary .troubleshoot-row td {
  padding: 2px 6px !important;
}
.data-table.compact-link-summary .troubleshoot-input {
  font-size: 12px !important;
  padding: 2px 6px !important;
}

/* Column resizer handle styling */
.data-table .col-resizer {
  background: linear-gradient(90deg, rgba(255,255,255,0.02), rgba(255,255,255,0.02));
}
.data-table .col-resizer:hover {
  background: linear-gradient(90deg, rgba(255,255,255,0.04), rgba(255,255,255,0.04));
}

/* Make the column resizer a narrow, absolutely-positioned handle on the right edge
   of header cells so users can drag to resize columns. Keep it visually subtle but
   ensure the cursor and hit target are obvious. */
.data-table .col-resizer {
  position: absolute;
  right: 0;
  top: 0;
  height: 100%;
  width: 8px;
  cursor: col-resize;
  z-index: 4;
  /* transparent base so the thin gradient shows without covering text */
  background: linear-gradient(90deg, rgba(255,255,255,0.02), rgba(255,255,255,0.02));
}
.data-table th { position: relative; }

/* === STATUS LABELS === */
.status-label {
  display: inline-block;
  padding: 2px 6px; /* slightly smaller padding to reduce width */
  border-radius: 5px;
  font-size: 12px;
  font-weight: 600;
  text-transform: capitalize;
  text-align: center;
  min-width: 64px; /* smaller min width so status pills don't push into neighboring columns */
  max-width: 100%;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}
.status-label.good {
  background: #002b00;
  color: #00ff66;
  border: 1px solid #00cc55;
  box-shadow: 0 0 6px rgba(0, 255, 102, 0.3);
}
.status-label.warning {
  background: #4d3300;
  color: #ffbb33;
  border: 1px solid #cc9900;
  box-shadow: 0 0 6px rgba(255, 187, 51, 0.3);
}
.status-label.accent {
  background: #00264d;
  color: #66aaff;
  border: 1px solid #0055cc;
  box-shadow: 0 0 6px rgba(102, 170, 255, 0.3);
}

/* Red pill for Diversity mappings */
.status-label.danger {
  background: #2b0000;
  color: #ff6666;
  border: 1px solid #cc3333;
  box-shadow: 0 0 6px rgba(255, 102, 102, 0.3);
}

/* Reduce status-pill size specifically inside data tables so pills (e.g. Diversity)
   don't get visually cut off when a column is narrow. This overrides the global
   min-width and padding for table contexts. */
.data-table .status-label {
  min-width: 36px !important;
  padding: 0 6px !important;
  font-size: 11px !important;
  line-height: 1 !important;
}

/* WF Finished pulsing badge */
.wf-finished-badge {
  display: inline-block;
  background-color: rgba(0,200,83,0.18);
}
@keyframes wfGreenPulse {
  0%, 100% { background-color: rgba(0,200,83,0.18); }
  50% { background-color: rgba(0,200,83,0.34); }
}
.wf-finished-pulse {
  animation: wfGreenPulse 1.8s ease-in-out infinite;
}

/* WF In Progress pulsing badge (blue) */
.wf-inprogress-badge {
  display: inline-block;
  /* stronger blue background to read as 'blue' */
  background: linear-gradient(90deg, #0078d4 0%, #005a9e 100%) !important;
  color: #ffdd57 !important; /* yellow text */
  text-shadow: 0 1px 0 rgba(0,0,0,0.45);
  padding: 6px 12px;
  font-weight: 700;
  border-radius: 10px;
  border: 1px solid rgba(0,90,150,0.6) !important;
  box-shadow: 0 8px 26px rgba(0,120,212,0.12), inset 0 -2px 8px rgba(255,255,255,0.02);
  font-size: 13px;
  vertical-align: middle;
}
/* small leading dot to echo the pulse (lighter blue) */
.wf-inprogress-badge::before {
  content: '';
  display: inline-block;
  width: 8px;
  height: 8px;
  border-radius: 50%;
  background: rgba(230,246,255,0.95);
  margin-right: 8px;
  box-shadow: 0 0 6px rgba(0,120,212,0.22);
}
@keyframes wfBluePulse {
  0% { transform: translateY(0) scale(1); box-shadow: 0 6px 18px rgba(0,120,212,0.04); }
  50% { transform: translateY(-2px) scale(1.02); box-shadow: 0 10px 28px rgba(0,120,212,0.10); }
  100% { transform: translateY(0) scale(1); box-shadow: 0 6px 18px rgba(0,120,212,0.04); }
}
.wf-inprogress-pulse {
  animation: wfBluePulse 2s ease-in-out infinite;
}

/* === BUTTONS === */
.open-btn {
  background-color: #107c10;
  border: none;
  color: #fff;
  padding: 3px 10px;
  border-radius: 4px;
  cursor: pointer;
  font-size: 12px;
  transition: all 0.2s ease;
}
.open-btn:hover {
  background-color: #0b6a0b;
  box-shadow: 0 0 8px #00cc33;
}
.uid-click {
  color: #50b3ff;
  cursor: pointer;
  font-weight: 500;
  transition: 0.2s ease;
  text-decoration: none;
}
.uid-click:hover {
  color: #79c0ff;
  text-shadow: 0 0 6px #50b3ff;
  text-decoration: none;
}

/* === SIDE BUTTONS === */
.side-buttons {
  display: flex;
  align-items: center;
  gap: 6px;
  flex-wrap: wrap;
}
.sleek-btn {
  padding: 4px 11px;
  border-radius: 4px;
  font-size: 12px;
  cursor: pointer;
  border: none;
  color: #fff;
  transition: all 0.15s ease-in-out;
}
.sleek-btn.danger {
  background: #b22222;
}
.sleek-btn.danger:hover {
  background: #d63030;
  box-shadow: 0 0 10px rgba(214, 48, 48, 0.35);
}
.sleek-btn.wan {
  background: #0078d4;
}
.sleek-btn.wan:hover {
  background: #106ebe;
  box-shadow: 0 0 8px #0078d4;
}
.sleek-btn.optical {
  background: #2b2b2b;
  border: 1px solid #444;
  color: #fff;
  font-size: 12px;
  border-radius: 6px;
  padding: 4px 10px;
  transition: all 0.2s ease-in-out;
}
.sleek-btn.optical:hover {
  background: #0078d4;
  box-shadow: 0 0 10px #0078d4;
}

/* Simple dark select to match sleek buttons */
.sleek-select {
  background: linear-gradient(180deg, #0f1620, #0c1116);
  color: #e6f6ff;
  border: 1px solid rgba(80,140,200,0.10);
  border-radius: 8px;
  padding: 6px 10px;
  height: 34px;
  min-width: 140px;
  max-width: 260px; /* keep the select column from stretching too wide */
  font-size: 13px;
  box-shadow: inset 0 -1px 0 rgba(255,255,255,0.02);
}

/* Ensure native select option list for sleek-select remains readable on dark theme.
   Some browsers/platforms render option backgrounds differently; force sensible
   dark background + light text and visible hover/selected states. */
.sleek-select option,
.sleek-select optgroup {
  background: #141414 !important;
  color: #e6f6ff !important;
}
.sleek-select option:hover,
.sleek-select option:focus,
.sleek-select option:checked {
  background: #003b6f !important; /* visible blue highlight */
  color: #fff !important;
}

/* Accent CTA used for primary Create Project buttons (green) */
.accent-cta {
  background: linear-gradient(90deg, #39b54a, #1e7f3a);
  border: 1px solid rgba(60,160,90,0.20);
  padding: 9px 22px;
  border-radius: 8px;
  font-weight: 600; /* match other primary button text weight */
  font-size: 13px;
  color: #ffffff;
  box-shadow: 0 10px 28px rgba(26,150,80,0.12), inset 0 -2px 8px rgba(255,255,255,0.02);
  transition: transform 140ms ease, box-shadow 140ms ease, opacity 140ms ease;
}
.accent-cta:hover {
  transform: translateY(-2px);
  box-shadow: 0 14px 36px rgba(26,150,80,0.18), inset 0 -2px 10px rgba(255,255,255,0.03);
}

/* Selection checkbox styling within tables (Associated UIDs column) */
.table-container input[type="checkbox"] {
  width: 14px;
  height: 14px;
  accent-color: #2fb85b; /* green accent */
  cursor: pointer;
  vertical-align: middle;
  margin: 0 6px; /* small breathing room inside cells */
}

/* Ensure selects inside dialogs (Fluent UI) respect the dark sleek-select theme */
.ms-Dialog select.sleek-select,
.ms-Dialog .sleek-select {
  background: linear-gradient(180deg, #0f1620, #0c1116) !important;
  color: #e6f6ff !important;
  border: 1px solid rgba(80,140,200,0.10) !important;
  box-shadow: inset 0 -1px 0 rgba(255,255,255,0.02) !important;
}

.table-container th[role="select-col"], .table-container th[aria-label="select-col"] { width: 44px; }

/* Labels before WAN/Optical buttons */
.side-label {
  color: #fff !important;
  font-weight: 600;
  white-space: nowrap;
}

/* Add vertical spacing around WAN/Optical buttons row */
.button-header-align-left {
  margin: 10px 0 12px;
}

/* UID Lookup Details buttons */
.details-buttons {
  display: flex;
  gap: 10px;
  flex-wrap: wrap;
  margin-top: 8px;
}
.sleek-btn.repo,
.sleek-btn.kmz {
  background: linear-gradient(90deg, #335c9a, #274b7a);
  border: 1px solid rgba(80, 140, 200, 0.35);
  color: #fff;
  border-radius: 6px;
  padding: 6px 12px;
}
.sleek-btn.repo:hover,
.sleek-btn.kmz:hover {
  background: linear-gradient(90deg, #3b67ab, #2f5689);
  box-shadow: 0 0 10px rgba(0, 120, 212, 0.35);
}

/* Stronger specificity for buttons that also have the accent CTA class.
   This ensures .accent-cta overrides the default .sleek-btn.repo styles. */
.sleek-btn.accent-cta,
.sleek-btn.repo.accent-cta,
.sleek-btn.kmz.accent-cta,
button.accent-cta {
  background: linear-gradient(90deg, #39b54a, #1e7f3a) !important;
  border: 1px solid rgba(60,160,90,0.20) !important;
  color: #ffffff !important;
  box-shadow: 0 10px 28px rgba(26,150,80,0.12), inset 0 -2px 8px rgba(255,255,255,0.02) !important;
  transform: none !important;
}
.sleek-btn.accent-cta:hover,
.sleek-btn.repo.accent-cta:hover,
.sleek-btn.kmz.accent-cta:hover,
button.accent-cta:hover {
  transform: translateY(-2px) !important;
  box-shadow: 0 14px 36px rgba(26,150,80,0.18) !important;
}

/* SRLG row alignment */
.srlg-line {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 10px;
  white-space: nowrap;
}
.srlg-actions {
  display: flex;
  gap: 14px;
  flex-shrink: 0;
}
.srlg-action { display: flex; flex-direction: column; align-items: flex-end; gap: 6px; }
.srlg-action-title {
  background: linear-gradient(90deg, #0078d4, #005a9e);
  color: #fff;
  font-weight: 600;
  font-size: 12px;
  padding: 3px 8px;
  border-radius: 4px;
  white-space: nowrap;
}
.srlg-text {
  color: #eee;
}

/* === FIBER VSO ASSISTANT === */
.vso-form-container.glow {
  background: radial-gradient(circle at 25% 20%, #1a1a1a, #0f0f0f);
  border: 1px solid #2b2b2b;
  border-radius: 14px;
  width: 500px;
  margin: 70px auto;
  padding: 34px 38px 32px;
  box-shadow: 0 0 25px rgba(0, 120, 212, 0.25), 0 0 10px rgba(0, 120, 212, 0.3);
  overflow: hidden;
  animation: pulseGlow 6s ease-in-out infinite;
  transition: all 0.3s ease-in-out;
}

/* limit dropdown callout inside the form to prevent double scrolls */
/* Only the inner items list should scroll; callout itself should not */
.ms-Dropdown-callout {
  max-height: none !important;
  overflow: visible !important;
  background-color: #181818 !important;
  border: 1px solid #333 !important;
  border-radius: 8px !important;
  box-shadow: 0 0 16px rgba(0, 120, 212, 0.3) !important;
}

/* Light-theme overrides for Dropdown callouts and items so the dropdown
   appears light when the document root has the `light-theme` class. */
.light-theme .ms-Dropdown-callout {
  background-color: #ffffff !important;
  border: 1px solid rgba(195, 218, 244, 0.6) !important;
  box-shadow: 0 6px 20px rgba(15, 23, 42, 0.06) !important;
}
.light-theme .ms-Dropdown-items {
  background-color: #ffffff !important;
  color: var(--vso-dropdown-text, #0f172a) !important;
}
.light-theme .ms-Dropdown-option {
  background: transparent !important;
  color: var(--vso-dropdown-text, #0f172a) !important;
}
.light-theme .ms-Dropdown-option:hover {
  background: var(--vso-dropdown-item-hover-bg, rgba(210,233,255,0.9)) !important;
  color: var(--vso-dropdown-text, #0f172a) !important;
}
.light-theme .ms-Dropdown-option.is-selected {
  background: var(--vso-dropdown-item-selected-bg, #e1f0ff) !important;
  color: var(--vso-dropdown-text, #0f172a) !important;
}

/* Explicit per-dropdown theme classes to ensure the closed Dropdown title
   (the visible control) matches theme even if Fluent or other rules apply. */
.dropdown-dark .ms-Dropdown-title {
  background-color: #141414 !important;
  color: #fff !important;
  border: 1px solid #333 !important;
}
.dropdown-dark .ms-Dropdown-caretDownWrapper { color: #fff !important; }

.dropdown-light .ms-Dropdown-title {
  background-color: #ffffff !important;
  color: var(--vso-dropdown-text, #0f172a) !important;
  border: 1px solid rgba(195, 218, 244, 0.6) !important;
}
.dropdown-light .ms-Dropdown-caretDownWrapper { color: var(--vso-dropdown-text, #0f172a) !important; }

/* make sure only internal content scrolls */
.vso-form-container.glow .ms-Dropdown-container {
  overflow: visible !important;
}

@keyframes pulseGlow {
  0% {
    box-shadow: 0 0 25px rgba(0, 120, 212, 0.25), 0 0 10px rgba(0, 120, 212, 0.3);
  }
  50% {
    box-shadow: 0 0 40px rgba(0, 120, 212, 0.4), 0 0 16px rgba(0, 120, 212, 0.5);
  }
  100% {
    box-shadow: 0 0 25px rgba(0, 120, 212, 0.25), 0 0 10px rgba(0, 120, 212, 0.3);
  }
}

/* === BANNER TITLE (legacy styles, disabled) === */
.banner-title-legacy {
  text-align: center;
  font-size: 28px;
  color: #fff;
  font-weight: 800;
  letter-spacing: 1px;
  padding: 16px 0;
  border-radius: 12px;
  background: linear-gradient(90deg, #0078d4 0%, #00aaff 50%, #0078d4 100%);
  margin-bottom: 28px;
  text-shadow: 0 0 18px rgba(0, 191, 255, 0.8), 0 0 28px rgba(0, 120, 212, 0.6);
  box-shadow: 0 0 25px rgba(0, 120, 212, 0.4);
  animation: bannerPulse 5s ease-in-out infinite;
}

@keyframes bannerPulse {
  0%, 100% {
    text-shadow: 0 0 18px rgba(0, 191, 255, 0.8), 0 0 28px rgba(0, 120, 212, 0.6);
  }
  50% {
    text-shadow: 0 0 26px rgba(0, 191, 255, 1), 0 0 40px rgba(0, 120, 212, 0.9);
  }
}

/* === INPUTS, LABELS, DROPDOWNS === */
.vso-form-container label {
  display: block;
  font-size: 15px;
  color: #ccc;
  margin-bottom: 6px;
  font-weight: 600;
}

.vso-form-container select,
.vso-form-container .ms-Dropdown-title {
  width: 100%;
  background-color: #141414 !important;
  color: #fff !important;
  border: 1px solid #333 !important;
  border-radius: 8px !important;
  padding: 10px 12px !important;
  font-size: 14px !important;
  margin-bottom: 20px;
  box-sizing: border-box;
  height: 42px !important;
  display: flex;
  align-items: center;
  transition: all 0.25s ease-in-out;
}

/* Typeable input inside the Data Center dropdown and text inputs */
.vso-form-container input {
  width: 100%;
  background: transparent !important;
  color: #fff !important;
  border: none !important; /* avoid double-border inside field groups */
  padding: 0 12px !important;
  height: 42px !important;
  box-sizing: border-box;
}

/* Match placeholder styling used as reference (e.g., AM111) */
.vso-form-container input::placeholder {
  color: #a6b7c6;
  opacity: 0.8;
  font-style: normal;
}

/* Make Fluent UI Dropdown placeholders match input placeholders */
.vso-form-container .ms-Dropdown-title.is-placeholder {
  color: #a6b7c6 !important;
  opacity: 0.8;
  font-style: normal;
  font-weight: 400;
}

.ms-Dropdown-title {
  display: flex !important;
  align-items: center !important;
  color: #fff !important;
  background: #141414 !important;
}

/* Reposition Dropdown caret to avoid covering text */
.vso-form-container .ms-Dropdown { position: relative !important; }
.vso-form-container .ms-Dropdown-title { padding-right: 36px !important; }
.vso-form-container .ms-Dropdown-caretDownWrapper {
  position: absolute !important;
  right: 8px !important;
  top: 50% !important;
  transform: translateY(-50%) !important;
  height: 28px !important;
  width: 28px !important;
  display: inline-flex !important;
  align-items: center !important;
  justify-content: center !important;
  pointer-events: auto !important;
}

/* Optional: add 'hide-caret' class on container to remove arrows entirely */
.vso-form-container.hide-caret .ms-ComboBox .ms-ComboBox-CaretDown-button,
.vso-form-container.hide-caret .ms-Dropdown-caretDownWrapper {
  display: none !important;
}

/* Ensure Dropdown placeholder matches TextField/ComboBox placeholder exactly */
.vso-form-container .ms-Dropdown-title.is-placeholder {
  color: #a6b7c6 !important;
  opacity: 0.8;
  font-style: normal;
  font-weight: 400;
}

/* Scroll inside dropdown only (not whole page) */
.ms-Dropdown-items {
  max-height: 240px !important;
  overflow-y: auto !important;
}

.ms-Dropdown-option {
  background: transparent !important;
  color: #fff !important;
  font-size: 13px !important;
  transition: background 0.15s;
}
.ms-Dropdown-option:hover {
  background-color: #0078d4 !important;
  color: #fff !important;
}
.ms-Dropdown-option.is-selected {
  background-color: #003b6f !important;
  color: #fff !important;
}

/* === COMBOBOX (Data Center) === */
.vso-form-container .ms-ComboBox {
  width: 100% !important;
  background-color: #141414 !important;
  border: 1px solid #333 !important;
  border-radius: 8px !important;
  height: 44px !important;
  display: flex !important;
  align-items: center !important;
  position: relative !important; /* allow absolute-positioned caret */
}
.vso-form-container .ms-ComboBox input.ms-ComboBox-Input {
  background: transparent !important;
  color: #fff !important;
  border: none !important;
  height: 100% !important;
  /* add right padding so text never sits under caret */
  padding: 0 36px 0 12px !important;
}
/* Show the caret so users can open the list */
.vso-form-container .ms-ComboBox .ms-ComboBox-CaretDown-button {
  /* pin caret to far right and keep clickable */
  position: absolute !important;
  right: 6px !important;
  top: 50% !important;
  transform: translateY(-50%) !important;
  height: 28px !important;
  width: 28px !important;
  min-width: 28px !important;
  display: inline-flex !important;
  align-items: center !important;
  justify-content: center !important;
  color: #fff !important;
  background: transparent !important;
  border-left: none !important; /* remove inner separator line */
  box-shadow: none !important;
}

/* === DATEPICKER (dark) === */
.vso-form-container .ms-DatePicker .ms-TextField-fieldGroup {
  background-color: #141414 !important;
  border: 1px solid #333 !important;
  border-radius: 8px !important;
  height: 42px !important;
}
.vso-form-container .ms-DatePicker .ms-TextField-field {
  color: #fff !important;
}
.vso-form-container .ms-DatePicker .ms-Callout-main,
.vso-form-container .ms-DatePicker .ms-DatePicker-callout {
  background: #181818 !important;
  border: 1px solid #333 !important;
}

/* Ensure DatePicker day cells and header match dark theme */
.vso-form-container .ms-DatePicker-dayButton,
.vso-form-container .ms-DatePicker .ms-DayPicker-weekday,
.vso-form-container .ms-DatePicker .ms-DayPicker-monthNav {
  background: transparent !important;
  color: #fff !important;
}

/* Reason multiline field should sit above other inputs and expand correctly */
.vso-form-container .reason-field .ms-TextField-fieldGroup {
  z-index: 2 !important; /* ensure it's above siblings if layout overlap occurs */
  position: relative !important;
  min-height: 140px !important;
  height: auto !important; /* override the global fixed height */
  align-items: flex-start !important; /* ensure content starts at the top */
}
.vso-form-container .reason-field .ms-TextField-field {
  color: #fff !important;
  background: transparent !important;
  padding-top: 8px !important; /* give the caret some top padding */
}

/* Ensure multiline text wraps and scrolls inside the reason box */
.vso-form-container .reason-field .ms-TextField-field {
  white-space: pre-wrap !important;
  overflow-wrap: break-word !important;
  word-break: break-word !important;
  max-height: 420px; /* reasonable maximum before internal scroll */
  overflow-y: auto !important;
}

.vso-form-container .reason-wrapper .reason-counter {
  color: #a6b7c6;
  background: rgba(0,0,0,0.2);
  padding: 2px 8px;
  border-radius: 8px;
}

/* === Compose container tweaks === */
.compose-container {
  border: 1px solid #2b2b2b;
  background: radial-gradient(circle at 30% 20%, #151515, #0f0f0f);
}
.compose-container .ms-MessageBar {
  margin-bottom: 10px;
}
.compose-container .ms-IconButton {
  color: #dfefff;
}
.compose-container .ms-IconButton:hover {
  color: #79c0ff;
}

/* Back button: blue arrow on themed background */
.back-button {
  background: linear-gradient(180deg, #0e1620 0%, #0b1219 100%) !important;
  border: 1px solid rgba(80, 160, 220, 0.18) !important;
  border-radius: 8px !important;
  padding: 6px !important;
  height: 38px !important;
  width: 38px !important;
  display: inline-flex !important;
  align-items: center !important;
  justify-content: center !important;
  /* subtle, neutral shadow to provide depth without glow */
  box-shadow: 0 2px 6px rgba(0,0,0,0.45) !important;
}
.back-button .ms-Button-icon, .back-button .ms-Icon {
  color: #50b3ff !important; /* standard accent blue */
  filter: none !important; /* remove strong glow */
}
.back-button:hover {
  border-color: rgba(80, 160, 220, 0.32) !important;
  box-shadow: 0 3px 8px rgba(0,0,0,0.5) !important;
}

/* Light theme fixes for remaining dark areas */
.light-theme .table-container {
  background: #ffffff;
  border-color: #e5e7eb;
  box-shadow: 0 0 0 1px rgba(15,23,42,0.03);
}

.light-theme .fiber-util-stats {
  background: transparent;
  color: var(--text-1);
}

.light-theme .fiber-util-stats .ms-TextField-fieldGroup {
  background: #ffffff !important;
  border-color: #c3daf4 !important;
}

.light-theme .fiber-util-stats .ms-TextField-field {
  color: #111827 !important;
}

.light-theme .fiber-util-stats button.search-btn {
  background: linear-gradient(90deg,#0078d4,#106ebe) !important;
  color: #ffffff !important;
}

.light-theme .compose-container {
  background: #ffffff !important;
  border-color: #d0d7e2 !important;
}

.light-theme .compose-container .ms-MessageBar {
  background: #f3f6fb !important;
  border-color: #d0d7e2 !important;
  color: #253858 !important;
}

.light-theme .compose-container textarea,
.light-theme .compose-container .ms-TextField-fieldGroup,
.light-theme .compose-container .ms-TextField-field {
  background: #ffffff !important;
  color: #111827 !important;
  border-color: #c3daf4 !important;
}

/* Email body preview container + text (VSO Assistant) */
.light-theme .compose-container .email-preview,
.light-theme .compose-container .email-preview pre,
.light-theme .compose-container .email-preview code {
  background: #ffffff !important;
  color: #111827 !important;
  border-color: #e5e7eb !important;
}

.light-theme .compose-container .email-preview-header {
  color: var(--vso-label-color) !important;
  font-weight: 700 !important;
}

/* Make form field labels and dropdown/combobox titles in the compose area more vivid */
.light-theme .compose-container .ms-Label,
.light-theme .compose-container label,
.light-theme .compose-container .ms-Dropdown-title,
.light-theme .compose-container .ms-ComboBox .ms-ComboBox-title,
.light-theme .compose-container .ms-TextField-label,
.light-theme .compose-container .compose-field-label {
  color: var(--vso-label-color) !important;
  font-weight: 600 !important;
}

.light-theme .compose-container .ms-Dropdown-title.is-placeholder {
  color: var(--vso-label-subtle) !important;
  font-weight: 400 !important;
}

/* Standardize all input headings in the light theme: color, size, weight */
.light-theme .vso-form-container .ms-Label,
.light-theme .vso-form-container label,
.light-theme .vso-form-container .ms-TextField-label,
.light-theme .vso-form-container .ms-Dropdown-title,
.light-theme .vso-form-container .ms-ComboBox .ms-ComboBox-title,
.light-theme .compose-container .ms-Label,
.light-theme .compose-container label,
.light-theme .compose-container .ms-TextField-label,
.light-theme .compose-container .ms-Dropdown-title,
.light-theme .compose-container .ms-ComboBox .ms-ComboBox-title {
  color: var(--vso-label-color) !important;
  font-size: 12px !important;
  font-weight: 600 !important;
  line-height: 1.2 !important;
}

.light-theme .vso-form-container .ms-Dropdown-title.is-placeholder,
.light-theme .compose-container .ms-Dropdown-title.is-placeholder {
  color: var(--vso-label-subtle) !important;
  font-weight: 400 !important;
}

.light-theme .back-button {
  background: #ffffff !important;
  border-color: #c3daf4 !important;
  box-shadow: 0 1px 3px rgba(15,23,42,0.18) !important;
}

.light-theme .back-button .ms-Button-icon,
.light-theme .back-button .ms-Icon {
  color: #0078d4 !important;
}

/* Light theme overrides */
:root.light-theme, .light-theme {
  --bg-1: #f5f7fa;
  --bg-2: #ffffff;
  --text-1: #111111;
  --muted: #444444;
  --accent: #0078d4;
  --vso-input-bg: #ffffff;
  --vso-input-border: rgba(0, 80, 160, 0.35);
  --vso-input-text: #0f172a;
  --vso-dropdown-bg: #ffffff;
  --vso-dropdown-item-hover-bg: rgba(210, 233, 255, 0.9);
  --vso-dropdown-item-selected-bg: #e1f0ff;
  --vso-dropdown-text: #0f172a;
  /* Updated to a vivid accessible Fluent accent blue for light theme labels */
  --accent-blue: #0F6CBD;
  --vso-label-color: var(--accent-blue);
  --vso-label-subtle: #52647a;
  --capacity-inner-bg: radial-gradient(circle at 30% 25%, #ffffff 0%, #f1f6ff 45%, #e5eefc 100%);
  --capacity-inner-shadow: inset 0 -4px 10px rgba(175, 195, 225, 0.35);
  --fiber-tooltip-bg: #f3f7ff;
  --fiber-tooltip-color: #102a43;
  --fiber-tooltip-subtle: #2c5282;
  /* Light-theme scrollbar overrides for table tracks and thumbs */
  --sb-track: #f3f6fb;
  --sb-track-glow: rgba(14,56,120,0.04);
  --sb-thumb: #9bbce8;
  --sb-thumb-2: #7aa4d9;
  --sb-thumb-border: rgba(11,37,74,0.08);
  --sb-thumb-hover: #6b98d6;
  --sb-thumb-hover-2: #4f7ec0;
}

/* Capacity text colors for light theme: make label/sub/main darker for readability */
:root.light-theme {
  --capacity-main-color: #007a33; /* darker green for the main metric */
  --capacity-label-color: #0b1220; /* dark label text */
  --capacity-sub-color: #475569;   /* muted dark for sub text */
}

.light-theme body {
  background-color: var(--bg-1) !important;
  color: var(--text-1) !important;
}
.light-theme .data-table td .uid-click,
.light-theme .data-table td span {
  color: var(--text-1) !important;
}
.light-theme .main {
  background-color: var(--bg-1) !important;
  color: var(--text-1) !important;
}
.light-theme .sidebar {
  background: #f6f8fa !important;
  box-shadow: 2px 0 10px rgba(0,0,0,0.06);
}
.light-theme .sidebar .ms-Nav-linkText {
  color: var(--text-1) !important;
}
.light-theme .dark-nav .ms-Nav-link {
  color: var(--muted) !important;
}
.light-theme .dark-nav .ms-Nav-link:hover,
.light-theme .dark-nav .ms-Nav-compositeLink.is-selected .ms-Nav-link {
  background: #0078d4 !important;
  color: #ffffff !important;
  box-shadow: 0 0 10px rgba(0,120,212,0.35);
}
.light-theme .logo-img {
  filter: drop-shadow(0 0 6px rgba(0,0,0,0.18));
}
.light-theme .vso-form-container {
  background: linear-gradient(180deg,#ffffff,#f7f9fb) !important;
  color: var(--text-1) !important;
  border: 1px solid rgba(0,0,0,0.06) !important;
  box-shadow: 0 0 20px rgba(15,23,42,0.06);
}
.light-theme .banner-title {
  background: linear-gradient(180deg,#e8f1fb,#d7e3f5);
  border-color: rgba(148,163,184,0.45);
}
.light-theme .banner-title .title-text {
  -webkit-text-fill-color: unset !important;
  background: none !important;
  color: var(--accent) !important;
  text-shadow: none !important;
}
.light-theme .banner-title .title-sub {
  color: #4b5563;
}
.light-theme .table-container {
  background: #ffffff;
  border-color: #e5e7eb;
  box-shadow: 0 0 0 1px rgba(15,23,42,0.03);
}

/* Light-theme: lighter scrollbar tracks for table containers and project rail */
.light-theme .table-container::-webkit-scrollbar-track,
.light-theme .projects-rail-list::-webkit-scrollbar-track,
.light-theme .notes-list::-webkit-scrollbar-track,
.light-theme .ms-Callout-main::-webkit-scrollbar-track,
.light-theme .ms-ComboBox-optionsContainer::-webkit-scrollbar-track,
.light-theme .ms-Dropdown-items::-webkit-scrollbar-track {
  background: linear-gradient(180deg, #f3f6fb, #eef6ff);
}

/* === Suggestions Page (strong light-theme overrides) === */
/* Ensure vivid blue labels for Description and Post anonymously regardless of component inline styles */
.light-theme .suggestions-form label,
.light-theme .suggestions-form .ms-Label,
.light-theme .suggestions-form .ms-TextField-label,
.light-theme .suggestions-form .ms-Checkbox-text {
  color: var(--vso-label-color) !important;
  font-weight: 600 !important;
}

/* Checkbox box (unchecked) styling */
.light-theme .suggestions-form .ms-Checkbox .ms-Checkbox-checkbox {
  border-color: var(--vso-label-color) !important;
  background: #ffffff !important;
  box-shadow: 0 0 0 1px rgba(15,23,42,0.08) !important;
  transition: background 120ms ease, border-color 120ms ease;
}

/* Hover focus for better affordance */
.light-theme .suggestions-form .ms-Checkbox:hover .ms-Checkbox-checkbox,
.light-theme .suggestions-form .ms-Checkbox:focus .ms-Checkbox-checkbox {
  border-color: var(--vso-label-color) !important;
  background: #f0f8ff !important; /* subtle blue tint */
}

/* Checked state: solid blue fill, white checkmark */
.light-theme .suggestions-form .ms-Checkbox.is-checked .ms-Checkbox-checkbox {
  background: var(--vso-label-color) !important;
  border-color: var(--vso-label-color) !important;
}
.light-theme .suggestions-form .ms-Checkbox.is-checked .ms-Checkbox-checkmark {
  color: #ffffff !important;
  font-weight: 700 !important;
}

/* Ensure the text beside the checkbox also uses vivid blue */
.light-theme .suggestions-form .ms-Checkbox.is-checked .ms-Checkbox-text,
.light-theme .suggestions-form .ms-Checkbox .ms-Checkbox-text {
  color: var(--accent) !important;
  font-size: 14px !important;
  font-weight: 700 !important;
  text-shadow: 0 0 4px rgba(0,120,212,0.18);
}

/* Strengthen textarea/input labels for Description field container */
.light-theme .suggestions-form .ms-TextField label,
.light-theme .suggestions-form .ms-TextField-label {
  color: var(--vso-label-color) !important;
  font-weight: 600 !important;
}

/* Optional: reinforce placeholder readability inside Description field */
.light-theme .suggestions-form .ms-TextField-field::placeholder {
  color: #6484a3 !important;
  opacity: 1 !important;
}
.light-theme html,
.light-theme body,
.light-theme .main,
.light-theme .table-container,
.light-theme .projects-rail-list {
  scrollbar-color: var(--sb-thumb) var(--sb-track);
}
.light-theme .data-table thead tr {
  background: linear-gradient(90deg,#0078d4,#0b5fad);
}
.light-theme .data-table tr:nth-child(even) {
  background: #f3f4f6;
}
.light-theme .data-table tbody tr:hover {
  background: #e5f1fb !important;
}
.light-theme .data-table td {
  color: #111827;
}
.light-theme .status-label.good {
  background: #dcfce7;
  color: #166534;
  border-color: #4ade80;
  box-shadow: none;
}
.light-theme .status-label.warning {
  background: #fef3c7;
  color: #92400e;
  border-color: #facc15;
  box-shadow: none;
}
.light-theme .status-label.accent {
  background: #dbeafe;
  color: #1d4ed8;
  border-color: #60a5fa;
  box-shadow: none;
}
.light-theme .notes-card {
  background: #ffffff;
  border-color: #e5e7eb;
  box-shadow: 0 1px 2px rgba(15,23,42,0.06);
}
.light-theme .notes-textarea {
  background: #f9fafb;
  color: #111827;
  border-color: #d1d5db;
}
.light-theme .note-item {
  background: #f9fafb;
  border-color: #e5e7eb;
}
.light-theme .note-text {
  color: #111827;
}
.light-theme .projects-rail {
  background: #ffffff;
  border-color: #e5e7eb;
  box-shadow: 0 10px 25px rgba(15,23,42,0.1);
}
.light-theme .projects-rail-header {
  background: linear-gradient(180deg,#edf2ff,#e0edff);
  border-color: rgba(129,140,248,0.6);
}
.light-theme .projects-rail-name {
  color: #111827;
}
.light-theme .projects-rail-sub {
  color: #4b5563;
}

/* Make the Projects header and title stand out in light theme */
.light-theme .projects-rail-header {
  background: linear-gradient(180deg,#f3f6fb,#ffffff);
  border-left: 4px solid var(--accent);
  box-shadow: none;
}
.light-theme .projects-rail-title {
  color: var(--accent);
  font-weight: 900;
  letter-spacing: 0.8px;
  text-shadow: none;
}

/* Section action buttons (rename, delete, collapse) — bright, bordered, and higher contrast */
.light-theme .projects-rail-section-title .section-action,
.light-theme .projects-rail-section-title .section-toggle {
  background: #ffffff;
  color: #0b1220;
  border: 1px solid #e5e7eb;
  box-shadow: 0 1px 4px rgba(15,23,42,0.06);
}
.light-theme .projects-rail-section-title .section-action.del:hover {
  background: #fff1f2;
  color: #7f1d1d;
  border-color: #fecaca;
}

/* Strong forceful overrides to ensure any remaining dark row backgrounds are light
   when the app is using the Light theme. These use !important to override
   inline styles set in components (safe because this only applies under
   `.light-theme`). */
.light-theme .data-table tbody tr {
  background: #ffffff !important;
}
.light-theme .data-table tbody tr:nth-child(even) {
  background: #f3f4f6 !important;
}
.light-theme .data-table tbody tr:hover {
  background: #e5f1fb !important;
}
.light-theme .data-table tbody tr td,
.light-theme .data-table tbody tr th {
  background: transparent !important; /* let the row show through */
  color: #0b1220 !important;
}

/* Ensure compact/alternate table variants also become light */
.light-theme .data-table.compact tbody tr,
.light-theme .data-table.compact-link-summary tbody tr,
.light-theme .data-table.compact-link-summary tbody tr td {
  background: #ffffff !important;
  color: #0b1220 !important;
}

/* Cards and panels that previously used hard-coded dark backgrounds in JSX */
.light-theme .decom-card,
.light-theme .decom-card-inner,
.light-theme .compose-container,
.light-theme .uid-compact-bar .compact-card,
.light-theme .spans-summary,
.light-theme .project-uids-box {
  background: #ffffff !important;
  border-color: #e6eef2 !important;
  box-shadow: 0 1px 6px rgba(15,23,42,0.04) !important;
  color: #0b1220 !important;
}

/* Tooltip and small dark helper panels used in the VSO assistant */
.light-theme .fiber-tooltip,
.light-theme .combo-dark-callout .ms-Callout-main,
.light-theme .combo-dark-callout .ms-ComboBox-optionsContainer,
.light-theme .ms-Dropdown-callout {
  background: #ffffff !important;
  color: #0b1220 !important;
  border-color: #e6eef2 !important;
}

/* Keep highlighted/selected rows visible but still light themed */
.light-theme .highlight-row {
  background: #e6f4ff !important;
  box-shadow: none !important;
  border-bottom: 1px solid #e6f4ff !important;
}

/* Make sure any small inline dark badges are readable in light theme */
.light-theme .wf-inprogress-badge,
.light-theme .wf-finished-badge {
  background: transparent !important;
  color: inherit !important;
  box-shadow: none !important;
}

/* Rail toggle (collapse) button */
.light-theme .projects-rail .rail-toggle-btn {
  background: #ffffff;
  color: #0b1220;
  border: 1px solid #e5e7eb;
  box-shadow: 0 2px 6px rgba(15,23,42,0.06);
}

/* Small navigation / back buttons inside the projects rail */
.light-theme .proj-navigate-btn,
.light-theme .proj-navigate-btn.tiny-icon-btn,
.light-theme .tiny-icon-btn {
  background: #ffffff;
  color: #0b1220;
  border: 1px solid #e6eef8;
  box-shadow: 0 1px 4px rgba(15,23,42,0.06);
}
.light-theme .proj-navigate-btn:hover,
.light-theme .tiny-icon-btn:hover { transform: translateY(-1px); }

/* Override the inline-colored 'Viewing:' span text to be prominent in light theme */
.light-theme .projects-rail-filter span {
  color: #0b1220 !important;
  font-weight: 700 !important;
}
.light-theme .uid-compact-bar .compact-card {
  background: #ffffff;
  border-color: #e5e7eb;
}
.light-theme .input-field .ms-TextField-fieldGroup {
  background: #ffffff;
  border-color: #60a5fa;
}
.light-theme .input-field input {
  color: #111827;
}
.light-theme .user-avatar {
  background: linear-gradient(180deg,#e5e7eb,#d1d5db);
  border-color: rgba(148,163,184,0.8);
}
.light-theme .user-email {
  color: #111827;
}

/* Additional light-theme polish for VSO/UID/Fiber inputs and panels */
.light-theme .vso-form-container.glow,
.light-theme .compose-container {
  background: #ffffff !important;
  border-color: #d0d7e2 !important;
  box-shadow: 0 10px 24px rgba(15,23,42,0.08) !important;
}

.light-theme .notice-banner {
  background: linear-gradient(180deg, #f9fafb, #edf2ff);
  border-color: rgba(148, 163, 184, 0.5);
  color: #111827;
}

.light-theme .banner-icon {
  color: #111827;
}

.light-theme .notes-card {
  background: #ffffff;
}

.light-theme .calendar-panel {
  background: #ffffff !important;
}

.light-theme .calendar-panel .rbc-toolbar {
  background: #f3f6fb;
  border-color: #d0d7e2;
}

.light-theme .calendar-panel .rbc-month-view,
.light-theme .calendar-panel .rbc-time-view {
  border-color: #d0d7e2;
}

/* Fix: make projects rail internals light in Light theme (filter area, items, controls)
   so the region under the header does not remain dark. */
.light-theme .projects-rail-filter {
  background: transparent; /* let the rail background show (which is white in light-theme) */
  z-index: 2;
}
.light-theme .projects-filter-input {
  background: #ffffff;
  border: 1px solid #e5e7eb;
  color: #0f172a;
}
.light-theme .projects-rail-section-title {
  color: #0b1220;
  text-shadow: none;
}
.light-theme .projects-rail-section-title .section-name {
  background: linear-gradient(180deg, #f3f6fb, #ffffff);
  border: 1px solid #e5e7eb;
  color: #0b1220;
  box-shadow: none;
}
.light-theme .projects-rail-item {
  background: #ffffff;
  border: 1px solid #e5e7eb;
  color: #0b1220;
  box-shadow: none;
}
.light-theme .projects-rail-name { color: #0b1220; }
.light-theme .projects-rail-sub { color: #6b7280; }
.light-theme .projects-rail-divider { background: linear-gradient(90deg, rgba(11,37,74,0.04), rgba(11,37,74,0.02)); }

.light-theme .calendar-panel .rbc-off-range-bg {
  background: #f2f2f2;
}

.light-theme .calendar-panel .rbc-date-cell {
  color: #20262e;
}

.light-theme .ai-summary-panel,
.light-theme .combined-horizontal {
  background: #ffffff;
  border-color: #d0d7e2;
  box-shadow: 0 10px 24px rgba(15,23,42,0.08);
  color: #111827;
}

.light-theme .ai-summary-header {
  color: #12355a;
  border-bottom-color: #c3daf4;
  text-shadow: none;
}

.light-theme .ai-chat-bubble {
  background: #f5f7fb;
  border-color: #d6e1f2;
  color: #253858;
}

/* Light-theme: make AI Summary details and Status tracker detail text darker and stronger */
.light-theme .ai-summary-body,
.light-theme .ai-summary-body div,
.light-theme .ai-summary-body span,
.light-theme .ai-summary-body b {
  color: var(--text-1) !important; /* dark text */
  font-weight: 700 !important;    /* stronger/bold */
}
.light-theme .ai-summary-label {
  color: var(--text-1) !important;
  font-weight: 700 !important;
}

/* Keep small controls (selects, dates) readable but slightly less heavy */
.light-theme .ai-summary-body .sleek-select,
.light-theme .ai-summary-body .ai-summary-date {
  font-weight: 600 !important;
  color: var(--text-1) !important;
}

/* Ensure AI Summary detail text matches Status Tracker detail size/style in light theme */
.light-theme .ai-summary-body {
  font-size: 11px !important; /* match Status Tracker */
}
.light-theme .ai-summary-body .ai-summary-key,
.light-theme .ai-summary-body b,
.light-theme .ai-summary-body span {
  font-size: 11px !important;
  font-weight: 700 !important;
  color: var(--text-1) !important;
}
.light-theme .ai-summary-body .sleek-select,
.light-theme .ai-summary-body .ai-summary-date {
  font-size: 11px !important;
  font-weight: 700 !important;
}

.light-theme .ms-TextField-fieldGroup,
.light-theme .vso-form-container .ms-ComboBox,
.light-theme .vso-form-container .ms-Dropdown-title,
.light-theme .vso-form-container .ms-DatePicker .ms-TextField-fieldGroup {
  background-color: #ffffff !important;
  border-color: #c3daf4 !important;
}

.light-theme .vso-form-container input,
.light-theme .vso-form-container .ms-ComboBox input.ms-ComboBox-Input,
.light-theme .vso-form-container .ms-TextField-field {
  color: #111827 !important;
}

.light-theme .vso-form-container input::placeholder,
.light-theme .vso-form-container .ms-TextField-field::placeholder {
  color: #6b778c !important;
}

/* Small helper class for inline optional text so it always matches the
   surrounding label's font and color. Use this in JSX as
   `<span className="optional-text">(Optional)</span>` to ensure consistent
   appearance in both themes. */
.optional-text {
  color: inherit !important;
  font-weight: 400 !important;
  font-style: normal !important;
  font-size: 13px !important;
  margin-left: 6px !important;
  vertical-align: baseline !important;
  opacity: 1 !important;
}

.light-theme .optional-text {
  /* in light theme if an outer element uses CSS variables, inherit will pick up
     the right value; keep this fallback to ensure subtle muted tone when used
     outside of a colored label */
  color: inherit !important;
}

/* Ensure short, inline bracketed labels (e.g. "(Optional)", "(Optical)") that were
   rendered with inline light colors inherit the surrounding text color in light
   theme. We match the common inline hex colors used in JSX and force them to
   inherit so they remain readable against white backgrounds. */
.light-theme .vso-form-container span[style*="#e6f6ff"],
.light-theme .vso-form-container span[style*="#a6b7c6"],
.light-theme .vso-form-container b[style*="#d0e7ff"],
.light-theme .vso-form-container span[style*="#cfe7ff"],
.light-theme .data-table span[style*="#e6f6ff"],
.light-theme .data-table span[style*="#a6b7c6"],
.light-theme .main-content span[style*="#e6f6ff"],
.light-theme .main-content span[style*="#a6b7c6"] {
  color: inherit !important;
  opacity: 1 !important;
}

.light-theme .vso-form-container .ms-ComboBox-Callout .ms-Callout-main,
.light-theme .vso-form-container .ms-ComboBox-optionsContainerWrapper,
.light-theme .combo-dark-callout .ms-Callout-main,
.light-theme .combo-dark-callout .ms-ComboBox-optionsContainerWrapper,
.light-theme .ms-Dropdown-callout,
.light-theme .ms-Dropdown-items,
.light-theme .ms-Dropdown-option {
  background: #ffffff !important;
  color: #111827 !important;
}

.light-theme .ms-Dropdown-option:hover,
.light-theme .combo-dark-callout .ms-ComboBox-option:hover {
  background: #e9f2ff !important;
}

.light-theme .rack-btn,
.light-theme .submit-btn,
.light-theme .search-btn,
.light-theme .sleek-btn {
  background: linear-gradient(90deg, #0078d4, #106ebe);
  color: #ffffff;
}

.light-theme .sleek-btn.danger {
  background: linear-gradient(90deg, #d13438, #a4262c);
}

/* UID Assistant: Add-to-project / action buttons inside notes/projects rail */
.light-theme .note-btn,
.light-theme .proj-action,
.light-theme .projects-rail-del {
  background: #f3f6fb;
  border-color: #c3daf4;
  color: #12355a;
}

.light-theme .note-btn:hover,
.light-theme .proj-action:hover,
.light-theme .projects-rail-del:hover {
  background: #e1edff;
  box-shadow: 0 0 8px rgba(15, 23, 42, 0.15);
}

/* Make native/select-based "Add to project" dropdown light in light-theme */
.light-theme .sleek-select {
  background: #ffffff !important;
  color: #111827 !important;
  border: 1px solid #c3daf4 !important;
  box-shadow: inset 0 -1px 0 rgba(0,0,0,0.02) !important;
}
.light-theme .sleek-select option,
.light-theme .sleek-select optgroup {
  background: #ffffff !important;
  color: #111827 !important;
}

/* Ensure the select in the projects toolbar matches the rail spacing */
.light-theme .projects-toolbar .sleek-select {
  min-width: 160px;
}

/* Config push / Circuits QC status inputs (inside UID status panel) */
.light-theme .status-input,
.light-theme .status-input input,
.light-theme .status-input .ms-TextField-fieldGroup {
  background: #ffffff !important;
  color: #111827 !important;
}

.light-theme .status-input-label {
  color: #12355a !important;
}

/* UID Status Tracker pills + dropdown/selects in light mode */
.light-theme .ai-summary-body {
  background: #f9fbff;
}

.light-theme .ai-summary-body .sleek-select,
.light-theme .ai-summary-body select {
  background: #ffffff !important;
  color: #111827 !important;
  border-color: #c3daf4 !important;
}

.light-theme .ai-summary-body option {
  background: #ffffff !important;
  color: #111827 !important;
}

.light-theme .ai-summary-body input[type="date"] {
  background: #ffffff !important;
  color: #111827 !important;
  border-color: #c3daf4 !important;
}

/* VSO tabs (A→Z, Facility, Z→A, Decom) */
.light-theme .tab-btn {
  background: linear-gradient(180deg, #ffffff, #edf5ff) !important;
  color: #12355a !important;
  border: 1px solid #c3daf4 !important;
}

.light-theme .tab-btn.active {
  background: linear-gradient(180deg, #0078d4, #106ebe) !important;
  color: #ffffff !important;
  box-shadow: 0 6px 18px rgba(0, 120, 212, 0.28) !important;
}

/* Ensure any inline elements inside ComboBox/Dropdown options inherit the
   light-theme text color. Some option labels include small spans with inline
   styles which remained dark on white backgrounds; force them to inherit so
   decommissioned span entries are visible in the dropdown. */
.light-theme .combo-dark-callout .ms-ComboBox-option span,
.light-theme .combo-dark-callout .ms-ComboBox-option div,
.light-theme .ms-ComboBox-option span,
.light-theme .ms-Dropdown-option span,
.light-theme .ms-Dropdown-item span {
  color: inherit !important;
  opacity: 1 !important;
}

/* Lookup button: make the PrimaryButton with class `lookup-btn` appear light
   and high-contrast when `.light-theme` is active. */
.light-theme .lookup-btn,
.light-theme .lookup-btn.ms-Button--primary {
  background: #ffffff !important;
  color: #12355a !important;
  border: 1px solid #c3daf4 !important;
  box-shadow: 0 2px 6px rgba(15,23,42,0.06) !important;
}

/* Dialog-specific overrides for the Event Details dialog to ensure dropdowns
   and callouts inside the dialog use light-theme backgrounds and readable text. */
.light-theme .dialog-event-details .ms-Callout-main,
.light-theme .dialog-event-details .ms-Dropdown-callout,
.light-theme .dialog-event-details .ms-Dropdown-items,
.light-theme .dialog-event-details .ms-Dropdown-item,
.light-theme .dialog-event-details .ms-Dropdown-option {
  background: var(--vso-dropdown-bg) !important;
  color: var(--vso-dropdown-text) !important;
  border-color: var(--vso-input-border) !important;
}

.light-theme .dialog-event-details .ms-Dropdown-title,
.light-theme .dialog-event-details .ms-ComboBox .ms-ComboBox-title {
  color: var(--vso-input-text) !important;
  background: var(--vso-input-bg) !important;
  border: 1px solid var(--vso-input-border) !important;
}

/* Ensure any inline spans inside dialog callouts inherit the readable color */
.light-theme .dialog-event-details .ms-Dropdown-item span,
.light-theme .dialog-event-details .ms-Callout .ms-ComboBox-option span {
  color: inherit !important;
}
.light-theme .lookup-btn:hover,
.light-theme .lookup-btn.ms-Button--primary:hover {
  background: #e8f6ff !important;
  color: #12355a !important;
}

/* VSO calendar header buttons (Today / Back / Next) use light theme */
.light-theme .calendar-panel .rbc-toolbar button {
  background: #ffffff;
  border-color: #c3daf4;
  color: #12355a;
}

.light-theme .calendar-panel .rbc-toolbar button:hover {
  background: #e1edff;
}

/* Fiber Span Utilization: chart + stats + disclaimer */
.light-theme .fiber-util-container {
  background: #ffffff;
  border: 1px solid #d0d7e2;
}

.light-theme .fiber-util-stats {
  color: #111827;
}

.light-theme .fiber-util-disclaimer .ms-MessageBar,
.light-theme .fiber-util-disclaimer {
  background: #f5f7fb !important;
  border-color: #d0d7e2 !important;
  color: #253858 !important;
}

/* DCAT Assistant coming soon headline */
.light-theme .dcat-coming-title {

/* Ensure Decommissioned Spans country ComboBox options are readable in light theme */
.light-theme .vso-form-container .combo-dark-callout .ms-ComboBox-optionsContainer,
.light-theme .vso-form-container .combo-dark-callout .ms-ComboBox-option {
  background-color: #ffffff !important;
  color: #0f172a !important;
}

.light-theme .vso-form-container .combo-dark-callout .ms-ComboBox-option:hover,
.light-theme .vso-form-container .combo-dark-callout .ms-ComboBox-option.is-selected,
.light-theme .vso-form-container .combo-dark-callout .ms-ComboBox-option.is-checked {
  background-color: #e5f1fb !important;
  color: #0b1220 !important;
}

/* === Global light-theme overrides for ANY Fluent UI ComboBox options (ensure dark readable text) === */
.light-theme .ms-ComboBox-optionsContainer,
.light-theme .combo-dark-callout .ms-ComboBox-optionsContainer {
  background: #ffffff !important;
}
.light-theme .ms-ComboBox-option,
.light-theme .combo-dark-callout .ms-ComboBox-option {
  background: #ffffff !important;
  color: #0f172a !important;
}
.light-theme .ms-ComboBox-option:hover,
.light-theme .combo-dark-callout .ms-ComboBox-option:hover,
.light-theme .ms-ComboBox-option.is-selected,
.light-theme .combo-dark-callout .ms-ComboBox-option.is-selected,
.light-theme .ms-ComboBox-option.is-checked,
.light-theme .combo-dark-callout .ms-ComboBox-option.is-checked {
  background: #e5f1fb !important;
  color: #0b1220 !important;
}
  color: #0078d4 !important;
}

/* UID Assistant: loading bar (ThemedProgressBar) in light mode */
.light-theme .themed-progress {
  background: transparent;
}

.light-theme .themed-progress-track {
  background: linear-gradient(90deg, #e3f2ff, #f5fbff);
  border-radius: 999px;
  border: 1px solid #c3daf4;
  box-shadow: inset 0 0 4px rgba(15,23,42,0.06);
}

.light-theme .themed-progress-bar {
  background: linear-gradient(90deg, #0078d4, #00a4ff);
  box-shadow: 0 0 10px rgba(0,120,212,0.4);
}

.light-theme .themed-progress-label {
  color: #12355a;
}

/* Light-theme: make Fluent UI Dropdown/ComboBox callouts and options readable */
.light-theme .ms-Callout,
.light-theme .ms-Callout .ms-List,
.light-theme .ms-Callout .ms-List-cell,
.light-theme .ms-Callout .ms-ContextualMenu,
.light-theme .ms-ContextualMenu,
.light-theme .ms-ContextualMenu .ms-ContextualMenu-item,
.light-theme .ms-ComboBox-callout,
.light-theme .ms-Dropdown-itemsWrapper,
.light-theme .ms-Dropdown-itemsWrapper .ms-List-cell {
  background: #ffffff !important;
  color: #0b1220 !important;
  border: 1px solid rgba(16,24,32,0.06) !important;
  box-shadow: 0 6px 18px rgba(14,56,120,0.04) !important;
}

/* Ensure individual dropdown items are readable and hover/select states keep dark text */
.light-theme .ms-List-cell,
.light-theme .ms-List-cell .ms-ContextualMenu-item,
.light-theme .ms-Dropdown-item,
.light-theme .ms-Dropdown-item:hover,
.light-theme .ms-Dropdown-item.is-selected,
.light-theme .ms-ComboBox-option {
  color: #0b1220 !important;
  background: #ffffff !important;
}

/* Make native selects and our sleek-select readable in light theme */
.light-theme select,
.light-theme .sleek-select,
.light-theme .sleek-select option,
.light-theme .sleek-select optgroup {
  color: #0b1220 !important;
  background: #ffffff !important;
}

/* Lookup button: light-themed appearance when .light-theme is active */
.light-theme .lookup-btn.ms-Button--primary,
.light-theme .lookup-btn {
  background: linear-gradient(90deg, #ffffff, #f6f8fb) !important;
  color: #0b1220 !important;
  border: 1px solid #c3daf4 !important;
  box-shadow: 0 6px 14px rgba(14,56,120,0.06) !important;
}
.light-theme .lookup-btn.ms-Button--primary:hover,
.light-theme .lookup-btn:hover {
  background: #f3f6fb !important;
  filter: none !important;
}


/* Fiber span utilization – light theme tweaks */
.light-theme .fiber-util-container {
  background: radial-gradient(circle at top left, #f6fbff 0, #eef5ff 38%, #e6f0ff 76%, #dde7ff 100%);
  border-color: rgba(0, 82, 155, 0.22);
  box-shadow: 0 18px 40px rgba(15, 61, 120, 0.15), 0 0 0 1px rgba(255, 255, 255, 0.4) inset;
}

.light-theme .fiber-util-stats {
  background: linear-gradient(180deg, rgba(0, 78, 146, 0.05), rgba(0, 78, 146, 0.02));
  border-radius: 10px;
  padding: 10px 12px;
}

.light-theme .fiber-util-chart {
  background: #ffffff;
  border-radius: 10px;
  border: 1px solid rgba(0, 80, 160, 0.18);
  box-shadow: 0 10px 30px rgba(0, 40, 90, 0.16);
}

/* Small MAX/MIN stat card used in Fiber Span Utilization */
.fiber-util-stat-card {
  background: #071821;
  border: 1px solid #28474f;
  padding: 6px 10px;
  border-radius: 8px;
  color: #dfefff;
  display: inline-flex;
  flex-direction: column;
  align-items: flex-start;
  min-width: 88px;
}
.fiber-util-stat-label { font-size: 11px; color: #9fb3c6; }
.fiber-util-stat-value { font-size: 14px; font-weight: 700; color: #dfefff; }

.light-theme .fiber-util-stat-card {
  background: #ffffff !important;
  border: 1px solid #e6eef2 !important;
  color: #0b1220 !important;
  box-shadow: 0 4px 10px rgba(15,23,42,0.04) !important;
}
.light-theme .fiber-util-stat-label { color: #52647a !important; }
.light-theme .fiber-util-stat-value { color: #0b1220 !important; }

.light-theme .fiber-util-disclaimer {
  margin-top: 12px;
}

/* Dark theme: make the Fiber Utilization disclaimer match app theme instead of bright yellow */
.fiber-util-disclaimer {
  margin-top: 12px;
}
.fiber-util-disclaimer .ms-MessageBar {
  background: #071821 !important;
  border: 1px solid #20343f !important;
  color: #dfefff !important;
  box-shadow: none !important;
}
.fiber-util-disclaimer .ms-MessageBar .ms-MessageBar-content,
.fiber-util-disclaimer .ms-MessageBar .ms-MessageBar-text {
  color: #cfe3ff !important;
}
.fiber-util-disclaimer .ms-MessageBar .ms-MessageBar-icon {
  color: #50b3ff !important;
}

/* Suggestions page (form + list) in light mode */
.light-theme .vso-form-container .ms-Dropdown,
.light-theme .vso-form-container .ms-Dropdown-title,
.light-theme .vso-form-container .ms-Dropdown-root {
  background-color: #ffffff;
  color: #1a1a1a;
  border-color: rgba(0, 80, 160, 0.35);
}

.light-theme .vso-form-container .ms-Dropdown-title {
  box-shadow: 0 0 0 1px rgba(255, 255, 255, 0.7) inset;
}

/* Ensure light-theme dropdown controls and native selects use dark text
   even when a global dark rule uses !important; enforce with !important. */
.light-theme .vso-form-container select,
.light-theme .vso-form-container .ms-Dropdown-title,
.light-theme .vso-form-container .ms-Dropdown-root {
  background-color: var(--vso-input-bg) !important;
  color: var(--vso-input-text) !important;
  border-color: var(--vso-input-border) !important;
}

/* Ensure Fluent UI ComboBox inputs (typeable dropdowns) show dark text in light theme */
.light-theme .vso-form-container .ms-ComboBox input.ms-ComboBox-Input,
.light-theme .vso-form-container .ms-ComboBox .ms-ComboBox-Input {
  color: var(--vso-input-text) !important;
  background: var(--vso-input-bg) !important;
}

.light-theme .vso-form-container .ms-ComboBox input.ms-ComboBox-Input::placeholder {
  color: var(--vso-input-placeholder) !important;
  opacity: 0.9 !important;
}
.light-theme .vso-form-container .ms-TextField-fieldGroup {
  background-color: #ffffff;
  border-color: rgba(0, 80, 160, 0.35);
}

.light-theme .vso-form-container .ms-TextField-field {
  color: #111827;
}

/* Strong, scoped overrides for SuggestionsPage form controls to ensure light-theme
   appearance even if other rules try to force dark styles. Scoped to vso-form-container
   so it doesn't affect other dark-intent widgets. */
.light-theme .vso-form-container .suggestions-form .ms-TextField-fieldGroup,
.light-theme .vso-form-container .ms-TextField-fieldGroup,
.light-theme .vso-form-container textarea,
.light-theme .vso-form-container .ms-TextField-field,
.light-theme .vso-form-container .ms-TextField-field::placeholder {
  background: var(--vso-input-bg) !important;
  color: var(--vso-input-text) !important;
  border: 1px solid var(--vso-input-border) !important;
}

/* Suggestions page specific: ensure labels, checkbox and controls are vivid */
.light-theme .vso-form-container .suggestions-form .ms-Label,
.light-theme .vso-form-container .suggestions-form label,
.light-theme .vso-form-container .suggestions-form .ms-TextField-label {
  color: var(--vso-label-color) !important;
  font-size: 12px !important;
  font-weight: 600 !important;
}

/* Checkbox visuals: make the box and check readable on light backgrounds */
.light-theme .vso-form-container .suggestions-form .ms-Checkbox {
  color: var(--vso-input-text) !important;
}
.light-theme .vso-form-container .suggestions-form .ms-Checkbox .ms-Checkbox-label,
.light-theme .vso-form-container .suggestions-form .ms-Checkbox .ms-Checkbox-text {
  color: var(--accent) !important;
  font-weight: 700 !important;
  font-size: 14px !important;
  text-shadow: 0 0 4px rgba(0,120,212,0.18);
}
.light-theme .vso-form-container .suggestions-form .ms-Checkbox .ms-Checkbox-checkbox {
  background: var(--vso-input-bg) !important;
  border: 1px solid var(--vso-input-border) !important;
  box-shadow: none !important;
}
.light-theme .vso-form-container .suggestions-form .ms-Checkbox input:checked ~ .ms-Checkbox-checkbox {
  background: linear-gradient(90deg, #0078d4, #106ebe) !important;
  border-color: var(--vso-input-border) !important;
}

/* Stronger, broader overrides to catch Fluent UI variations and inline styles */
.light-theme .vso-form-container .suggestions-form .ms-Checkbox,
.light-theme .vso-form-container .suggestions-form .ms-Checkbox * {
  color: var(--vso-input-text) !important;
}
.light-theme .vso-form-container .suggestions-form .ms-Checkbox .ms-Checkbox-checkbox .ms-Icon,
.light-theme .vso-form-container .suggestions-form .ms-Checkbox .ms-Checkbox-checkbox svg {
  fill: #ffffff !important; /* icon (check) color when checked - on blue background */
}
.light-theme .vso-form-container .suggestions-form .ms-Checkbox .ms-Checkbox-checkbox {
  width: 18px !important;
  height: 18px !important;
}

/* Make the Submit button prominent and ensure label/placeholder text are dark */
.light-theme .vso-form-container .suggestions-form .search-btn,
.light-theme .vso-form-container .suggestions-form .submit-btn,
.light-theme .vso-form-container .suggestions-form .ms-Button {
  background: linear-gradient(90deg, #0078d4, #106ebe) !important;
  color: #ffffff !important;
}

/* Ensure the checkbox label and control text are readable */
.light-theme .vso-form-container .ms-Checkbox,
.light-theme .vso-form-container .ms-Checkbox .ms-Checkbox-label {
  color: var(--vso-input-text) !important;
}

/* Make the submit button prominent and consistent inside suggestion forms */
.light-theme .vso-form-container .search-btn,
.light-theme .vso-form-container .submit-btn {
  background: linear-gradient(90deg, #0078d4, #106ebe) !important;
  color: #ffffff !important;
  border: 1px solid var(--vso-input-border) !important;
}

/* Community suggestions dropdowns / list actions should be light */
.light-theme .notes-card .ms-Dropdown,
.light-theme .notes-card .ms-Dropdown-title,
.light-theme .notes-card .ms-Dropdown-items,
.light-theme .notes-card .ms-Dropdown-item,
.light-theme .notes-card .ms-Dropdown-option {
  background: var(--vso-dropdown-bg) !important;
  color: var(--vso-dropdown-text) !important;
  border-color: var(--vso-input-border) !important;
}

/* Force any inline spans inside notes list to inherit readable color */
.light-theme .notes-list span[style],
.light-theme .note-item span[style] {
  color: inherit !important;
}

.light-theme .notes-card {
  background: #ffffff;
  border-color: rgba(0, 80, 160, 0.22);
}

.light-theme .note-item {
  background: linear-gradient(180deg, #f9fbff, #f3f7ff);
  border-color: rgba(0, 80, 160, 0.18);
}

.light-theme .note-alias {
  color: #0b2b4a;
}

.light-theme .wf-inprogress-badge {
  background: #e6f3ff;
  color: #005a9e !important;
  border-color: rgba(0, 90, 158, 0.35) !important;
}

.light-theme .note-text {
  color: #111827;
}

/* Ensure the danger/delete note button is readable on light backgrounds */
.light-theme .note-btn.danger {
  background: linear-gradient(90deg, #d13438, #a4262c) !important;
  border-color: rgba(160,40,48,0.12) !important;
  color: #ffffff !important;
}
.light-theme .note-btn.danger:hover {
  box-shadow: 0 0 8px rgba(209, 52, 56, 0.14) !important;
}

/* VSO Assistant – Decommissioned spans card */
.light-theme .decom-card {
  background: linear-gradient(180deg, #f8fbff, #edf4ff);
  border-color: rgba(0, 80, 160, 0.26);
  box-shadow: 0 14px 32px rgba(11, 59, 120, 0.18);
}

.light-theme .decom-card-header {
  color: #052c4f;
}

.light-theme .decom-card-inner {
  background: #ffffff;
  border-color: rgba(0, 80, 160, 0.22);
}

.light-theme .decom-card-inner div {
  color: #1f2933;
}

/* Wirecheck Automation dialog tweaks for light mode */
.light-theme .wirecheck-dialog .ms-Dialog-main {
  background: #ffffff !important;
  border-color: rgba(0, 80, 160, 0.25) !important;
  box-shadow: 0 18px 40px rgba(15, 61, 120, 0.18) !important;
}

.light-theme .wirecheck-dialog .ms-Dialog-title,
.light-theme .wirecheck-dialog .ms-Dialog-subText {
  color: #111827 !important;
}

.light-theme .wirecheck-dialog .code-block {
  background: var(--vso-input-bg) !important;
  color: var(--text-1) !important;
  border-radius: 8px;
  border: 1px solid var(--vso-input-border) !important;
  padding: 12px !important;
  box-shadow: none !important;
}

/* Disable animations helper */
.no-animations * {
  animation: none !important;
  transition: none !important;
}

/* Light-theme styling for Create-from-Associated-UIDs overlay */
.light-theme .create-from-assoc-overlay {
  /* slightly brighter page backdrop for light theme */
  background: rgba(11,18,32,0.35) !important;
}
.light-theme .create-from-assoc-panel {
  background: linear-gradient(180deg, #ffffff, #fbfcff) !important;
  border: 1px solid rgba(16,24,32,0.06) !important;
  color: #0b1220 !important;
  box-shadow: 0 18px 40px rgba(15,61,120,0.06) !important;
}
.light-theme .create-from-assoc-panel .ms-Spinner-label {
  color: #0b1220 !important;
}
.light-theme .create-from-assoc-panel .ms-Spinner {
  color: #0b1220 !important;
}
.light-theme .create-from-assoc-panel .ms-Dialog-actions,
.light-theme .create-from-assoc-panel .ms-Dialog-footer {
  background: transparent !important;
}

/* Admin/Oper status arrows: ensure clear colors in light theme */
.status-arrow { transition: color 160ms ease; }
.light-theme .status-arrow.up { color: #107c10 !important; /* green */ }
.light-theme .status-arrow.down { color: #d13438 !important; /* red */ }

/* Messages inside the create-from-assoc panel */
.create-from-assoc-panel .create-from-assoc-message {
  color: #bfe6ff; /* readable on dark panel */
}
.create-from-assoc-panel .create-from-assoc-success {
  color: #c8ffd6; /* success color on dark panel */
  font-size: 17px;
  font-weight: 800;
  letter-spacing: 0.2px;
}
.light-theme .create-from-assoc-panel .create-from-assoc-message {
  color: #0b1220 !important; /* stronger dark text for light theme */
  font-size: 13px;
}
.light-theme .create-from-assoc-panel .create-from-assoc-success {
  color: #0b662a !important; /* stronger green for success on light bg */
  font-size: 18px !important;
  font-weight: 900 !important;
  text-shadow: none !important;
}

/* Default (dark theme) styling for the project-assembled success box */
.create-from-assoc-panel .create-from-assoc-success {
  display: inline-block;
  background: rgba(14, 88, 47, 0.12);
  color: #9ff3c4;
  padding: 8px 12px;
  border-radius: 10px;
  font-size: 16px;
  font-weight: 800;
  margin-bottom: 8px;
  box-shadow: 0 6px 18px rgba(0,0,0,0.5);
}

/* Make the success box subtle on light theme (dark green text on pale background) */
.light-theme .create-from-assoc-panel .create-from-assoc-success {
  background: #eef9ef !important;
  color: #0b662a !important;
  box-shadow: 0 8px 20px rgba(12,42,20,0.06) !important;
}

/* Modal text paragraph inside dialog content: default dark theme */
.ms-Dialog[class*="dialog-"] .modal-text {
  color: #e6f6ff;
  line-height: 1.5;
}

/* In light theme, ensure confirmation/modal text is dark and readable */
.light-theme .ms-Dialog[class*="dialog-"] .modal-text {
  color: #0b1220 !important;
}

/* Stronger, more generic override in case the dialog class is applied to a
   wrapper element instead of the `.ms-Dialog` node. This ensures the
   delete-project confirmation text always appears dark in light-theme. */
.light-theme .dialog-delete-project .modal-text,
.light-theme [class*="dialog-delete-project"] .modal-text,
.light-theme .dialog-delete-project .ms-Dialog-subText,
.light-theme [class*="dialog-delete-project"] .ms-Dialog-subText {
  color: #0b1220 !important;
}

/* Generic: make any modal that has a dialog-<type> class use light dialog styles in light theme */
.light-theme .ms-Dialog[class*="dialog-"] .ms-Dialog-main,
.light-theme .ms-Dialog[class*="dialog-"] .ms-Dialog-inner,
.light-theme .ms-Dialog[class*="dialog-"] .ms-Dialog-content {
  background: linear-gradient(180deg, #ffffff, #fbfcff) !important;
  color: #0b1220 !important;
  border: 1px solid rgba(16,24,32,0.06) !important;
  box-shadow: 0 18px 40px rgba(15,61,120,0.06) !important;
}
.light-theme .ms-Dialog[class*="dialog-"] .ms-Dialog-subText {
  color: #0b1220 !important;
}
.light-theme .ms-Dialog[class*="dialog-"] .ms-TextField .ms-TextField-fieldGroup {
  background: #ffffff !important;
  border: 1px solid rgba(16,24,32,0.08) !important;
}
.light-theme .ms-Dialog[class*="dialog-"] .ms-Dialog-actions {
  border-top: 1px solid rgba(16,24,32,0.06) !important;
  background: transparent !important;
}

/* ---------------------------------------------------------------------------
   Generic light-theme overrides for Fluent UI dialogs / callouts
   Ensure any modal, dialog or callout uses a light background and readable
   dark text when the app root has the `.light-theme` class.
   This covers Create Project, Delete Project, confirmation dialogs, callouts
   and other popup panels that inherit `.ms-Dialog` / `.ms-Callout` styles.
   ------------------------------------------------------------------------ */
.light-theme .ms-Dialog .ms-Dialog-main,
.light-theme .ms-Dialog .ms-Dialog-inner,
.light-theme .ms-Dialog .ms-Dialog-content,
.light-theme .ms-Callout-main,
.light-theme .ms-Callout {
  background: linear-gradient(180deg, #ffffff, #fbfcff) !important;
  color: #0b1220 !important;
  border: 1px solid rgba(16,24,32,0.06) !important;
  box-shadow: 0 18px 40px rgba(15,61,120,0.06) !important;
}

.light-theme .ms-Dialog .ms-Dialog-title,
.light-theme .ms-Callout .ms-Callout-title {
  color: #0b1220 !important;
}

.light-theme .ms-Dialog .ms-Dialog-subText,
.light-theme .ms-Callout .ms-Callout-subText {
  color: #34414a !important;
}

/* Text fields, selects, and other form elements inside dialogs */
.light-theme .ms-Dialog .ms-TextField .ms-TextField-fieldGroup,
.light-theme .ms-Callout .ms-TextField .ms-TextField-fieldGroup {
  background: #ffffff !important;
  border: 1px solid rgba(16,24,32,0.08) !important;
  color: #0b1220 !important;
}
.light-theme .ms-Dialog .ms-TextField .ms-TextField-field,
.light-theme .ms-Callout .ms-TextField .ms-TextField-field {
  color: #0b1220 !important;
  background: transparent !important;
}

.light-theme .ms-Dialog select.sleek-select,
.light-theme .ms-Callout select.sleek-select,
.light-theme .ms-Dialog .sleek-select,
.light-theme .ms-Callout .sleek-select {
  background: #ffffff !important;
  color: #0b1220 !important;
  border: 1px solid rgba(16,24,32,0.08) !important;
  box-shadow: none !important;
}
.light-theme .ms-Dialog .sleek-select option,
.light-theme .ms-Callout .sleek-select option {
  background: #ffffff !important;
  color: #0b1220 !important;
}

/* Buttons inside dialogs: default buttons should be readable on light bg */
.light-theme .ms-Dialog .ms-Button--default,
.light-theme .ms-Callout .ms-Button--default {
  background: #f6f8fa !important;
  border: 1px solid rgba(16,24,32,0.08) !important;
  color: #0b1220 !important;
}
.light-theme .ms-Dialog .ms-Button--primary,
.light-theme .ms-Callout .ms-Button--primary {
  /* keep accent but ensure contrast on light bg */
  box-shadow: 0 6px 16px rgba(26,120,200,0.12) !important;
}

/* Ensure dialog action rows don't appear as dark bars */
.light-theme .ms-Dialog .ms-Dialog-actions,
.light-theme .ms-Callout .ms-Callout-actions {
  background: transparent !important;
  border-top: 1px solid rgba(16,24,32,0.04) !important;
}

/* Small inputs / code blocks that purposely remain dark can keep contrast
   but ensure their labels are visible */
.light-theme .ms-Dialog .emergency-name,
.light-theme .ms-Dialog .emergency-subtext {
  color: #0b1220 !important;
}

/* Compact mode */
.compact-mode .vso-form-container { padding: 18px 22px 20px !important; }
.compact-mode .banner-title { padding: 8px 10px 8px !important; }

/* === Dialog Polish (Emergency Prompt) === */
/* Add breathing room for the dialog title and remove any scrollbars/arrows */
.ms-Dialog-title {
  margin-top: 12px !important;
  margin-bottom: 8px !important;
}
/* Ensure prompt never shows scrollbars/arrows */
.ms-Dialog .ms-Dialog-inner,
.ms-Dialog .ms-Dialog-content,
.ms-Dialog .ms-Dialog-scrollableContent {
  overflow: hidden !important;
  max-height: none !important;
}
/* Hide any platform scrollbars/buttons inside dialog across engines */
.ms-Dialog * { scrollbar-width: none !important; }
.ms-Dialog *::-webkit-scrollbar { width: 0 !important; height: 0 !important; }
.ms-Dialog *::-webkit-scrollbar-button { display: none !important; width: 0 !important; height: 0 !important; }
/* removed custom emergency-modal overrides to restore clarity */

/* Compose grid for tidy alignment */
.compose-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
  gap: 12px;
  align-items: end;
}
.compose-grid .span-2 {
  grid-column: span 2;
}

/* Softer policy info banner */
.policy-info {
  margin-bottom: 12px;
  padding: 10px 12px;
  border-radius: 10px;
  border: 1px solid rgba(120, 160, 200, 0.25);
  background: linear-gradient(180deg, #0e1620 0%, #0b1219 100%);
  color: #c9d7e1;
  box-shadow: 0 0 10px rgba(0, 0, 0, 0.35), inset 0 0 8px rgba(0, 0, 0, 0.2);
}
.policy-info b { color: #dfefff; }

/* Remove default pseudo-element borders that can appear as a faint line */
.vso-form-container .ms-ComboBox::before,
.vso-form-container .ms-ComboBox::after {
  border: none !important;
  box-shadow: none !important;
}

/* Dark callout + options for ComboBox */
.vso-form-container .ms-ComboBox-Callout .ms-Callout-main,
.vso-form-container .ms-ComboBox-optionsContainerWrapper,
.combo-dark-callout .ms-Callout-main,
.combo-dark-callout .ms-ComboBox-optionsContainerWrapper {
  background: #181818 !important;
  border: 1px solid #333 !important;
  box-shadow: 0 6px 16px rgba(0,0,0,0.6) !important;
}
.vso-form-container .ms-ComboBox-optionsContainerWrapper,
.combo-dark-callout .ms-ComboBox-optionsContainerWrapper {
  /* prevent outer wrapper from adding its own scrollbar; inner container will scroll */
  max-height: none !important;
  overflow: visible !important;
}
.vso-form-container .ms-ComboBox-optionsContainer,
.combo-dark-callout .ms-ComboBox-optionsContainer {
  max-height: 240px !important;
  overflow-y: auto !important;
}
.vso-form-container .ms-ComboBox-option,
.combo-dark-callout .ms-ComboBox-option {
  background: transparent !important;
  color: var(--vso-dropdown-text) !important; /* theme-aware: dark text in light theme */
  padding: 8px 12px !important;
  cursor: pointer;
}
.vso-form-container .ms-ComboBox-option:hover,
.vso-form-container .ms-ComboBox-option.is-selected,
.vso-form-container .ms-ComboBox-option.is-checked,
.combo-dark-callout .ms-ComboBox-option:hover,
.combo-dark-callout .ms-ComboBox-option.is-selected,
.combo-dark-callout .ms-ComboBox-option.is-checked {
  background: var(--vso-dropdown-item-selected-bg) !important;
  color: var(--vso-dropdown-text) !important; /* keep readable in light theme */
}

/* Callout beak color to match dark theme */
.combo-dark-callout .ms-Callout-beak,
.combo-dark-callout .ms-Callout-beakCurtain {
  background: #181818 !important;
  border-color: #333 !important;
}

/* Make the dropdown/callout border visually continuous with the control by hiding the beak
   and nudging the callout up so its border meets the control's bottom border. This avoids
   a visible gap or double-border between the control and its list. */
.combo-dark-callout .ms-Callout-beak,
.combo-dark-callout .ms-Callout-beakCurtain {
  display: none !important;
}
.combo-dark-callout .ms-Callout-main,
.ms-ComboBox-Callout .ms-Callout-main,
.ms-Dropdown-callout {
  margin-top: -1px !important; /* overlap the 1px borders so they appear continuous */
  border-top-left-radius: 0 !important;
  border-top-right-radius: 0 !important;
}
/* Remove the bottom radius from the control so the callout joins seamlessly */
.vso-form-container .ms-ComboBox,
.vso-form-container .ms-Dropdown-title {
  border-bottom-left-radius: 0 !important;
  border-bottom-right-radius: 0 !important;
}

/* === BUTTONS === */
.vso-form-container button {
  border: none;
  border-radius: 8px;
  font-size: 13px;
  font-weight: 600;
  cursor: pointer;
  padding: 9px 22px;
  transition: all 0.25s ease-in-out;
}
.vso-form-container .submit-btn {
  background-color: #0078d4;
  color: #fff;
  box-shadow: 0 0 8px rgba(0, 120, 212, 0.4);
}
.vso-form-container .submit-btn:hover {
  background-color: #0b66c3;
  box-shadow: 0 0 14px rgba(0, 120, 212, 0.6);
}
.vso-form-container .help-btn {
  background-color: #b22222;
  color: white;
  box-shadow: 0 0 8px rgba(178, 34, 34, 0.4);
}
.vso-form-container .help-btn:hover {
  background-color: #d63030;
  box-shadow: 0 0 14px rgba(214, 48, 48, 0.6);
}

/* === CONTINUE BUTTON === */
.ms-Button--primary.is-disabled {
  background-color: #333 !important;
  color: #777 !important;
  box-shadow: none !important;
}

/* === NOTICE BANNERS (VSO Assistant) === */
.notice-banner {
  margin-top: 18px; /* add a touch more space under buttons */
  padding: 12px 14px;
  border-radius: 10px;
  display: flex;
  align-items: center;
  gap: 10px;
  border: 1px solid rgba(200, 210, 230, 0.25);
  background: linear-gradient(180deg, #0f1a24 0%, #0b141c 100%);
  color: #d6e9ff;
  box-shadow: 0 0 14px rgba(0, 120, 212, 0.25), inset 0 0 10px rgba(0, 0, 0, 0.35);
}
.notice-banner.warning {
  border-color: rgba(245, 205, 120, 0.4); /* softer amber */
  box-shadow: 0 0 12px rgba(245, 205, 120, 0.18), inset 0 0 10px rgba(0, 0, 0, 0.35);
}
.notice-banner .banner-icon {
  width: 24px;
  height: 24px;
  border-radius: 50%;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  color: #ffdd57 !important; /* yellow text */
  font-size: 14px;
  flex: 0 0 24px;
  color: #0a0a0a;
  background: radial-gradient(circle at 30% 30%, #f3d891, #e6b85c); /* softer yellow */
  box-shadow: 0 0 10px rgba(230, 184, 92, 0.4);
}
.notice-banner .banner-text {
  line-height: 1.5;
  color: #dfefff;
.light-theme .wf-inprogress-badge {
  /* In light theme, keep the badge readable and make the text use the warning color */
  color: #92400e !important; /* amber/darker yellow */
  background: linear-gradient(180deg, #fef3c7, #fde68a) !important; /* pale yellow background */
  border-color: #fcd34d !important;
  box-shadow: 0 6px 18px rgba(252, 211, 77, 0.08) !important;
}

.light-theme .wf-finished-badge {
  color: #166534 !important; /* green text for completed */
  background: linear-gradient(180deg, #dcfce7, #bbf7d0) !important; /* pale green bg */
  border-color: #86efac !important;
  box-shadow: 0 6px 18px rgba(34,197,94,0.06) !important;
}
}

/* Projects-rail specific notice styling: improve typography and appearance for the
   short export warning shown in the projects rail filter. Keeps a subtle, modern
   card look in dark theme and a clean, readable look in light theme. */
.projects-rail .notice-banner {
  padding: 10px 12px;
  border-radius: 8px;
  display: flex;
  align-items: center;
  gap: 8px;
  background: linear-gradient(180deg, rgba(6,22,34,0.06), rgba(6,22,34,0.02));
  border: 1px solid rgba(11,37,74,0.06);
  color: #cfe7ff;
  box-shadow: none;
  font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
  font-weight: 600;
  font-size: 13px;
  line-height: 1.25;
}
.projects-rail .notice-banner .banner-icon {
  width: 22px;
  height: 22px;
  flex: 0 0 22px;
  font-size: 12px;
  color: #07324a;
  background: radial-gradient(circle at 30% 30%, #ffdca0, #f1b85a);
  box-shadow: 0 0 6px rgba(0,0,0,0.08);
}

/* Light-theme override for the projects rail notice to match the white rail */
.light-theme .projects-rail .notice-banner {
  background: linear-gradient(180deg,#f8fbff,#f3f9ff);
  border: 1px solid #e6f2ff;
  color: #0b1220;
  box-shadow: 0 2px 6px rgba(14,56,120,0.04);
}
.light-theme .projects-rail .notice-banner .banner-icon {
  background: radial-gradient(circle at 30% 30%, #fff2d9, #ffdca8);
  color: #19324a;
}

/* === RACK ELEVATION BUTTON === */
.rack-btn {
  display: inline-block;
  background: linear-gradient(90deg, #0078d4, #005a9e);
  color: #fff;
  padding: 10px 18px;
  border-radius: 8px;
  font-weight: 600;
  text-decoration: none;
  transition: all 0.25s ease-in-out;
  box-shadow: 0 0 10px rgba(0, 120, 212, 0.4);
}
.rack-btn.slim {
  padding: 4px 18px;
  font-size: 12px;
  border-radius: 6px;
  background: linear-gradient(90deg, #335c9a, #274b7a);
  box-shadow: 0 0 6px rgba(0, 120, 212, 0.25);
  border: 1px solid rgba(80, 140, 200, 0.25);
}
.rack-btn.slim:hover {
  background: linear-gradient(90deg, #3b67ab, #2f5689);
  box-shadow: 0 0 10px rgba(0, 120, 212, 0.35);
}
.rack-btn:hover {
  background: #0b66c3;
  box-shadow: 0 0 18px rgba(0, 120, 212, 0.6);
  transform: scale(1.05);
}

/* ===== NOTES / CHATBOX ===== */
.notes-card {
  background: radial-gradient(circle at 25% 20%, #161616, #0f0f0f);
  border: 1px solid #2b2b2b;
  border-radius: 12px;
  padding: 10px 12px 12px;
  box-shadow: 0 0 18px rgba(0,0,0,0.5), inset 0 0 8px rgba(255,255,255,0.03);
  margin-top: 14px;
}
.notes-input-row {
  display: grid;
  grid-template-columns: 1fr auto;
  gap: 8px;
  align-items: start;
}
.notes-textarea {
  width: 100%;
  background: #141414;
  color: #dfefff;
  border: 1px solid #2f2f2f;
  border-radius: 8px;
  padding: 8px 10px;
  font-family: inherit;
  font-size: 13px;
  resize: vertical;
}
.notes-textarea:focus { outline: none; box-shadow: 0 0 0 2px rgba(80,160,255,0.18); }
.notes-actions { display: flex; gap: 8px; }
.notes-user-hint { grid-column: 1 / -1; font-size: 12px; color: #9ab; margin-top: 2px; }

.notes-list { margin-top: 10px; display: flex; flex-direction: column; gap: 8px; }
.note-item { background: linear-gradient(180deg, rgba(12,12,12,0.9), rgba(8,8,8,0.95)); border: 1px solid #242424; border-radius: 10px; padding: 8px 10px; }
.note-header { display: flex; align-items: center; justify-content: space-between; gap: 8px; }
.note-meta { color: #a6b7c6; font-size: 12px; display: flex; align-items: center; gap: 6px; }
.note-alias { color: #c9ffd8; font-weight: 700; }
.note-email { color: #8fb3ff; }
.note-dot { opacity: 0.6; }
.note-time { color: #9aa; }
.note-body { margin-top: 6px; }
.note-text { color: #e6f6ff; white-space: pre-wrap; word-wrap: break-word; }
.notes-textarea.inline-edit { margin-top: 4px; }
.note-controls { display: inline-flex; gap: 6px; }
.note-btn {
  background: #2b2b2b;
  color: #e6f6ff;
  border: 1px solid #3a3a3a;
  padding: 4px 10px;
  border-radius: 6px;
  font-size: 12px;
  cursor: pointer;
  display: inline-block;
}
.note-btn:hover { background: #334; box-shadow: 0 0 8px rgba(80,160,255,0.15); }
.note-btn.danger {
  background: #3a1313;
  border-color: #4a1a1a;
  color: #ffffff !important;
  display: inline-block;
}
.note-btn.danger:hover { background: #4a1717; box-shadow: 0 0 8px rgba(255,77,77,0.18); }
.note-empty { color: #9aa; font-size: 12px; text-align: center; padding: 10px 0; }

/* ===== PROJECTS RAIL (visible on UID Assistant) ===== */
.projects-rail {
  position: fixed;
  top: 70px;
  left: 248px; /* sit next to the main sidebar (240px) */
  width: clamp(200px, 20vw, 280px); /* default width; inline style will override when resizable */
  height: calc(100vh - 80px);
  background: linear-gradient(180deg, rgba(10,12,16,0.96), rgba(8,10,14,0.98)); /* slightly cooler tone vs main menu */
  border: 1px solid #2b2b2b;
  border-radius: 10px;
  box-shadow: 0 8px 28px rgba(0,0,0,0.55);
  padding: 8px 8px 10px;
  z-index: 1200;
  overflow: hidden; /* no horizontal scrollbar on the rail */
  transition: width 160ms ease, padding 160ms ease;
}
/* Resizer handle on the right edge */
.projects-rail .projects-rail-resizer {
  position: absolute;
  top: 0;
  right: -4px; /* overlap slightly to make grabbing easier */
  width: 8px;
  height: 100%;
  cursor: col-resize;
  background: transparent;
}
.projects-rail .projects-rail-resizer::after {
  content: '';
  position: absolute;
  top: 0; bottom: 0; left: 3px; width: 2px;
  background: linear-gradient(180deg, rgba(80,179,255,0.0), rgba(80,179,255,0.25), rgba(80,179,255,0.0));
  opacity: 0.4;
}
.projects-rail .projects-rail-resizer:hover::after,
.projects-rail .projects-rail-resizer:focus::after {
  opacity: 0.8;
}
.projects-rail .rail-toggle-btn {
  width: 24px;
  height: 24px;
  border-radius: 6px;
  background: #0f0f0f;
  border: 1px solid #2b2b2b;
  color: #dfefff;
  box-shadow: 0 2px 8px rgba(0,0,0,0.5);
  display: inline-flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
}
.projects-rail .rail-toggle-btn:hover { background: #141414; box-shadow: 0 0 10px rgba(80,179,255,0.25), 0 2px 10px rgba(0,0,0,0.5); }
.projects-rail.collapsed {
  width: 30px; /* ensure toggle is fully visible */
  padding: 6px 2px; /* reduce interior padding */
}
.projects-rail.collapsed .projects-rail-resizer { display: none; }
.projects-rail.collapsed .projects-rail-header {
  border-left: none;            /* remove left stripe to free width */
  padding: 4px 3px;             /* tighter padding to center the button */
  justify-content: center;      /* center the toggle in the slim rail */
}
.projects-rail.collapsed .projects-rail-title { display: none; }
.projects-rail.collapsed .projects-rail-list { display: none; }
.projects-rail-header {
  color: #bfe8ff;
  font-weight: 800;
  font-size: 13px;
  letter-spacing: 0.4px;
  border-left: 4px solid #50b3ff;
  padding: 8px 8px 8px 10px;
  margin-bottom: 8px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  border-radius: 8px;
  background: linear-gradient(180deg, rgba(14,22,30,0.9), rgba(12,18,26,0.86));
  box-shadow: inset 0 0 0 1px rgba(80,179,255,0.06), 0 2px 10px rgba(0,0,0,0.4);
}
.projects-rail-title {
  white-space: nowrap;
  color: #f3fbff;
  font-size: 18px;
  font-weight: 900;
  letter-spacing: 0.6px;
  text-transform: uppercase;
  text-shadow: 0 0 8px rgba(80,179,255,0.18);
}
.projects-rail-title::before {
  content: "";
  display: inline-block;
  width: 12px;
  height: 12px;
  margin-right: 8px;
  border-radius: 50%;
  background: radial-gradient(circle at 35% 35%, rgba(80,179,255,0.85), rgba(30,90,150,0.55));
  border: 1px solid rgba(80,179,255,0.55);
  box-shadow: 0 0 10px rgba(80,179,255,0.28), inset 0 0 6px rgba(255,255,255,0.06);
  vertical-align: -1px;
}
.projects-rail-list { overflow-y: auto; overflow-x: hidden; height: calc(100% - 28px); display: flex; flex-direction: column; gap: 6px; }
.projects-rail-empty { color: #88a; font-size: 12px; text-align: center; margin-top: 10px; }
.projects-rail-filter { padding: 2px 2px 6px; position: sticky; top: 0; background: linear-gradient(180deg, rgba(14,14,14,0.98), rgba(14,14,14,0.92)); z-index: 2; }
.projects-filter-input { width: 100%; background: #0f0f0f; border: 1px solid #282828; color: #dfefff; border-radius: 6px; padding: 6px 8px; font-size: 12px; }
.projects-filter-input:focus { outline: none; box-shadow: 0 0 0 2px rgba(80,179,255,0.18); }
.projects-filter-controls { display: flex; gap: 6px; align-items: center; flex-wrap: wrap; margin-top: 6px; }
.filter-check { display: inline-flex; align-items: center; gap: 6px; font-size: 12px; color: #cfe7ff; }
.filter-check input { accent-color: #0078d4; }
.projects-rail-section { display: flex; flex-direction: column; gap: 6px; }
.projects-rail-section + .projects-rail-section { margin-top: 8px; }
.projects-rail-divider { height: 1px; background: linear-gradient(90deg, rgba(80,179,255,0.08), rgba(200,220,255,0.25), rgba(80,179,255,0.08)); margin: 6px 2px; border-radius: 999px; }
.projects-rail-section-title { display: flex; align-items: center; justify-content: space-between; gap: 8px; color: #eef7ff; font-weight: 900; font-size: 15px; letter-spacing: 0.35px; margin: 8px 4px 4px; opacity: 0.98; text-shadow: 0 0 6px rgba(80,179,255,0.18); }
.projects-rail-section-title .section-toggle { background: #151515; color: #e6f6ff; border: 1px solid #2b2b2b; border-radius: 6px; width: 20px; height: 20px; cursor: pointer; display: inline-flex; align-items: center; justify-content: center; font-size: 12px; }
.projects-rail-section-title .section-name {
  display: inline-block;
  max-width: 72%;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding: 3px 10px;
  border-radius: 999px;
  background: linear-gradient(180deg, #0e1620, #0b1219);
  border: 1px solid rgba(80,160,220,0.28);
  color: #f3fbff;
  box-shadow: 0 2px 10px rgba(0,0,0,0.35), inset 0 0 8px rgba(255,255,255,0.02);
}
.projects-rail-section-title .section-name:hover {
  border-color: rgba(80,160,220,0.42);
  box-shadow: 0 3px 12px rgba(0,0,0,0.45), 0 0 10px rgba(80,179,255,0.18), inset 0 0 10px rgba(255,255,255,0.03);
}
.projects-rail-section-title .section-actions { display: inline-flex; gap: 4px; }
.projects-rail-section-title .section-action { background: #151515; color: #e6f6ff; border: 1px solid #2b2b2b; border-radius: 6px; width: 20px; height: 20px; cursor: pointer; display: inline-flex; align-items: center; justify-content: center; font-size: 12px; }
.projects-rail-section-title .section-action:hover { background: #1c1c1c; }
.projects-rail-section-title .section-action.del:hover { background: #3a1313; border-color: #4a1a1a; }
.projects-rail-item {
  display: flex; align-items: center; justify-content: space-between; gap: 6px;
  background: #151515; border: 1px solid #242424; border-radius: 8px; padding: 6px 8px;
  cursor: pointer;
}
.projects-rail-item.urgent { border-color: #7a1a1a; box-shadow: 0 0 10px rgba(255,80,80,0.16); }
.projects-rail-badges { display: flex; gap: 6px; align-items: center; margin-top: 2px; }
.proj-urgent-badge { display: inline-block; padding: 2px 8px; border-radius: 999px; background: linear-gradient(180deg, #3a1313, #2a0e0e); border: 1px solid rgba(220,80,80,0.45); color: #ffb3b3; font-size: 11px; font-weight: 800; letter-spacing: 0.4px; text-transform: uppercase; }
.proj-action.urgent.on { color: #ff7b7b; background: #3a1313; border-color: #5a1a1a; box-shadow: 0 0 10px rgba(255,120,120,0.28), inset 0 0 6px rgba(255,255,255,0.04); }
.projects-rail-item.active { border-color: #3a74b8; box-shadow: 0 0 10px rgba(80,179,255,0.18); }
.projects-rail-item.pinned { border-color: #bfa400; box-shadow: 0 0 12px rgba(255,215,0,0.25), 0 0 18px rgba(255,170,0,0.15); }
.projects-rail-main { display: flex; flex-direction: column; gap: 4px; cursor: pointer; }
.projects-rail-name { color: #e6f6ff; font-weight: 700; font-size: 13px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
.projects-rail-sub { color: #9ab; font-size: 11px; }
.projects-rail-subrow { display: flex; align-items: center; justify-content: space-between; gap: 6px; }
.projects-rail-metrics { margin-top: 2px; display: flex; flex-direction: column; gap: 2px; }
.proj-metric-line { font-size: 11px; color: #dfefff; display: flex; align-items: center; gap: 8px; flex-wrap: wrap; }
/* Blue pill for link distribution */
.proj-metric-line .proj-dist {
  display: inline-flex;
  align-items: center;
  padding: 2px 8px;
  border-radius: 999px;
  background: linear-gradient(90deg, #0f2540, #0c1e33);
  border: 1px solid rgba(80,160,220,0.32);
  color: #cfe7ff;
  font-weight: 800;
  letter-spacing: 0.2px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.35), inset 0 0 6px rgba(255,255,255,0.03);
}
/* Subtle middle dot as separator */
.proj-metric-line .proj-sep {
  width: 6px;
  height: 6px;
  border-radius: 50%;
  background: rgba(200, 220, 255, 0.35);
  display: inline-block;
}
/* Green pill for total capacity */
.proj-metric-line .proj-cap {
  display: inline-flex;
  align-items: center;
  padding: 2px 8px;
  border-radius: 999px;
  background: linear-gradient(90deg, #113a28, #0f2f22);
  border: 1px solid rgba(80, 220, 160, 0.28);
  color: #a8f3c9;
  font-weight: 900;
  letter-spacing: 0.25px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.35), inset 0 0 6px rgba(255,255,255,0.03);
}
.proj-metric-line .proj-cap-total {
  display: inline-flex;
  align-items: center;
  padding: 2px 6px;
  border-radius: 999px;
  background: transparent;
  color: #9adfbf;
  font-weight: 700;
  opacity: 0.95;
}
.proj-date-line { font-size: 11px; color: #cfe7ff; }
.proj-date-line .proj-date-label { opacity: 0.85; margin-right: 6px; }
.projects-rail-owners { color: #c9ffd8; font-size: 11px; white-space: pre-line; line-height: 1.2; }
.projects-rail-actions { display: inline-flex; align-items: center; gap: 4px; }
.projects-rail-actions-inline { display: inline-flex; align-items: center; gap: 6px; flex-wrap: nowrap; margin-left: 16px; }
.proj-action { background: #2b2b2b; color: #e6f6ff; border: 1px solid #3a3a3a; border-radius: 6px; width: 22px; height: 22px; cursor: pointer; font-size: 12px; line-height: 1; display: inline-flex; align-items: center; justify-content: center; }
.proj-action.on { color: #ffd700; border-color: #5a4a00; background: #3a3200; box-shadow: 0 0 10px rgba(255,215,0,0.35), inset 0 0 6px rgba(255,255,255,0.06); transform: translateY(-1px) scale(1.05); }

/* Stronger highlight for the star (pin) */
.proj-action.pin.on {
  color: #ffe65c;
  background: radial-gradient(circle at 30% 30%, rgba(255,215,0,0.25), rgba(58,50,0,0.95));
  border-color: #8a7400;
  box-shadow: 0 0 14px rgba(255,215,0,0.45), 0 0 22px rgba(255,215,0,0.2), inset 0 0 8px rgba(255,255,255,0.06);
  animation: pinPulse 2.2s ease-in-out infinite;
}
@keyframes pinPulse {
  0%, 100% {
    transform: translateY(-1px) scale(1.05);
    box-shadow: 0 0 14px rgba(255,215,0,0.35), 0 0 18px rgba(255,215,0,0.15), inset 0 0 6px rgba(255,255,255,0.05);
  }
  50% {
    transform: translateY(-2px) scale(1.08);
    box-shadow: 0 0 20px rgba(255,235,140,0.6), 0 0 28px rgba(255,215,0,0.28), inset 0 0 8px rgba(255,255,255,0.08);
  }
}
.proj-action.del:hover { background: #3a1313; border-color: #4a1a1a; }
.projects-rail-del { background: #2b2b2b; color: #e6f6ff; border: 1px solid #3a3a3a; border-radius: 6px; width: 26px; height: 26px; cursor: pointer; }
.projects-rail-del:hover { background: #3a1313; border-color: #4a1a1a; }
.projects-rail-empty-mini { color: #667; font-size: 11px; margin: 0 6px 6px; }
.projects-rail-section.dropping { outline: 1px dashed rgba(80,179,255,0.35); background: rgba(10,22,34,0.25); border-radius: 6px; }

/* Light theme for projects rail cards */
.light-theme .projects-rail-item {
  background: linear-gradient(180deg, #eef7ff, #e6f0ff); /* light blue shaded card */
  border-color: #d0e7ff;
  box-shadow: 0 4px 10px rgba(14, 56, 120, 0.06);
  transition: transform 140ms ease, box-shadow 140ms ease, background 140ms ease;
}
.light-theme .projects-rail-item:hover {
  transform: translateY(-4px);
  box-shadow: 0 10px 26px rgba(14, 56, 120, 0.10);
  background: linear-gradient(180deg, #f6fbff, #eaf4ff);
}

.light-theme .projects-rail-badges .proj-urgent-badge {
  background: linear-gradient(180deg, #fdecec, #fbd5d5);
  border-color: #f97373;
  color: #7f1d1d;
}

.light-theme .projects-rail-main,
.light-theme .projects-rail-name,
.light-theme .projects-rail-subrow,
.light-theme .proj-metric-line,
.light-theme .proj-date-line,
.light-theme .projects-rail-owners {
  color: #111827;
}

/* Light-theme: make the small action buttons match the light palette and improve contrast */
.light-theme .proj-action,
.light-theme .projects-rail-del {
  background: #ffffff;
  color: #0b1220;
  border: 1px solid #e5e7eb;
  box-shadow: 0 2px 6px rgba(15,23,42,0.06);
}
.light-theme .proj-action:hover,
.light-theme .projects-rail-del:hover {
  background: #f3f6fb;
  transform: translateY(-1px);
}
.light-theme .proj-action.del,
.light-theme .projects-rail-del.del {
  background: #fff1f2;
  color: #7f1d1d;
  border-color: #fecaca;
  box-shadow: none;
}
.light-theme .proj-action.pin.on {
  color: #8a4b00;
  background: linear-gradient(180deg,#fff7e6,#fff1d6);
  border-color: #f0c36a;
  box-shadow: 0 4px 12px rgba(250,200,100,0.12);
}

/* Make small helper text and notices more prominent in light theme */
.light-theme .projects-rail-empty-mini {
  color: #475569;
  font-weight: 600;
}
.light-theme .notice-banner .banner-text {
  color: #0b1220;
  font-weight: 700;
}

/* Ensure section actions and tiny icon buttons read well */
.light-theme .projects-rail-actions .proj-action,
.light-theme .projects-rail-actions-inline .proj-action,
.light-theme .tiny-icon-btn {
  background: #ffffff;
  color: #0b1220;
  border: 1px solid #e6eef8;
}
.light-theme .tiny-icon-btn { box-shadow: 0 1px 4px rgba(15,23,42,0.06); }

/* Hide the fixed projects rail on smaller screens to prevent overlap/overflow */
@media (max-width: 1200px) {
  .projects-rail { display: none; }
}

/* === FOOTER === */
.vso-form-container hr {
  border: none;
  border-top: 1px solid #2a2a2a;
  margin: 18px 0 12px;
}
.vso-form-container .disclaimer {
  font-size: 11px;
  color: #aaa;
  line-height: 1.4;
  text-align: left;
}
.vso-form-container .developer {
  font-size: 11px;
  color: #999;
  margin-top: 6px;
}
.vso-form-container .developer a {
  color: #50b3ff;
  text-decoration: none;
}
.vso-form-container .developer a:hover {
  text-decoration: underline;
  text-shadow: 0 0 6px #50b3ff;
}

/* === DIALOG (dark theme overrides) === */
.ms-Dialog {
  color: #dfefff;
}
.ms-Dialog .ms-Dialog-main {
  /* darker, slightly translucent background so the dialog contrasts with the page */
  background: linear-gradient(180deg, rgba(6,8,10,0.95), rgba(4,6,8,0.92)) !important;
  border: 2px solid rgba(0,170,255,0.28) !important; /* defined neon-blue border */
  box-shadow: 0 0 18px rgba(0,170,255,0.22), 0 14px 40px rgba(0,0,0,0.65) !important; /* soft neon + depth */
  border-radius: 10px !important;
}

/* Force a comfortable default width for the emergency prompt and ensure it's responsive and centered */
.ms-Dialog .ms-Dialog-main {
  /* use block layout so width constraints are predictable and won't create inline overflow */
  display: block !important;
  width: auto !important;
  max-width: 720px !important;          /* slightly larger dialog so subtext comfortably fits two lines */
  min-width: 420px !important;          /* avoid overly small dialogs */
  margin: 0 auto !important;            /* center the dialog */
  box-sizing: border-box !important;
  padding: 0 !important;                /* content areas handle padding */
  overflow: hidden !important;          /* hide any overflow to eliminate scrollbars */
  position: relative !important;        /* needed for the neon pseudo-element positioning */
  z-index: 9999 !important;             /* ensure dialog sits above page glow */
}
.ms-Dialog .ms-Dialog-title {
  color: #50b3ff !important;
  font-weight: 700 !important;
  text-align: center !important; /* center the title */
  display: block !important;
  width: 100% !important;
}
.ms-Dialog .ms-Dialog-subText {
  color: #a6b7c6 !important;
}

/* Create Project instruction text: default (dark theme) and light-theme override */
.ms-Dialog.dialog-create-project .create-project-instruction {
  color: #cfe7ff; /* original soft blue for dark theme */
  font-size: 13px;
}
.light-theme .ms-Dialog.dialog-create-project .create-project-instruction {
  color: #0b1220 !important; /* stronger dark text for light theme */
  font-weight: 600;
}
.ms-Dialog .ms-Dialog-actions {
  border-top: 1px solid #1f1f1f !important;
  background: transparent !important;
  padding: 12px 16px !important;
  display: flex !important;
  gap: 12px !important;
  justify-content: center !important;
  flex-wrap: wrap !important; /* allow buttons to wrap instead of forcing width */
}
.ms-Dialog .ms-Button {
  border-radius: 8px !important;
  min-width: 0 !important; /* prevent buttons from expanding dialog width */
}
.ms-Dialog .ms-Button--primary {
  background: linear-gradient(90deg, #0078d4, #00aaff) !important;
  color: #fff !important;
  box-shadow: 0 6px 16px rgba(0,120,212,0.25) !important;
}
.ms-Dialog .ms-Button--primary:hover {
  filter: brightness(1.05) !important;
}
.ms-Dialog .ms-Button.accent-cta,
.ms-Dialog .ms-Button.accent-cta.ms-Button--primary {
  /* Ensure dialog primary button uses the green accent when explicitly requested */
  background: linear-gradient(90deg, #39b54a, #1e7f3a) !important;
  border: 1px solid rgba(60,160,90,0.20) !important;
  box-shadow: 0 6px 16px rgba(26,150,80,0.25) !important;
  color: #ffffff !important;
}

/* If the dialog is specifically the Create Project modal, force the primary
   button to the green accent so it stands out regardless of button className
   handling by the Fluent UI PrimaryButton wrapper. */
.ms-Dialog.dialog-create-project .ms-Button--primary {
  background: linear-gradient(90deg, #39b54a, #1e7f3a) !important;
  border: 1px solid rgba(60,160,90,0.20) !important;
  box-shadow: 0 6px 18px rgba(26,150,80,0.28) !important;
  color: #ffffff !important;
}
.ms-Dialog .ms-Button--default {
  background: transparent !important;
  border: 1px solid #333 !important;
  color: #dfefff !important;
}

/* Dialog text fields: dark background to avoid white pop-out */
.ms-Dialog .ms-TextField .ms-TextField-fieldGroup {
  background: #0f0f0f !important;
  border: 1px solid #2a2a2a !important;
  border-radius: 8px !important;
}
.ms-Dialog .ms-TextField:hover .ms-TextField-fieldGroup {
  border-color: #3a3a3a !important;
}
.ms-Dialog .ms-TextField.is-focused .ms-TextField-fieldGroup,
.ms-Dialog .ms-TextField .ms-TextField-fieldGroup:focus-within {
  box-shadow: 0 0 0 2px rgba(80,179,255,0.18) !important;
  border-color: #3a74b8 !important;
}
.ms-Dialog .ms-TextField .ms-TextField-field {
  background: transparent !important;
  color: #dfefff !important;
}
.ms-Dialog .ms-TextField .ms-TextField-field::placeholder {
  color: #98a7b6 !important;
}
/* Dialog field labels and descriptions: make text readable (white/blue) */
.ms-Dialog .ms-TextField .ms-Label {
  color: #50b3ff !important; /* neon blue to match theme */
  font-weight: 700 !important;
}
.ms-Dialog .ms-TextField .ms-TextField-description {
  color: #cfe7ff !important; /* light blue for helper text */
}

/* Emergency dialog tweaks: red label, single-line title, and no internal scrollbars */
.ms-Dialog .emergency-name {
  color: #ff4d4d !important; /* vivid red to indicate emergency */
  background: rgba(255,77,77,0.06);
  padding: 6px 10px;
  border-radius: 6px;
  border: 1px solid rgba(255,77,77,0.12);
  box-shadow: 0 4px 12px rgba(255,77,77,0.06);
  font-size: 14px;
  letter-spacing: 0.6px;
}

/* Prevent the dialog content from showing scrollbars — present as a solid prompt */
.ms-Dialog .ms-Dialog-main,
.ms-Dialog .ms-Dialog-inner,
.ms-Dialog .ms-Dialog-content {
  /* Force the dialog to never show scrollbars; we will clamp long text instead */
  overflow-x: hidden !important; /* hide horizontal scroll specifically */
  overflow-y: hidden !important; /* hide vertical scrollbars for the prompt */
  box-sizing: border-box !important;
  width: 100% !important; /* make sure inner areas match container width */
}

/* Safeguard: prevent any descendant from introducing horizontal scroll */
.ms-Dialog, .ms-Dialog * {
  overflow-x: hidden !important;
}

/* Force the dialog title to a single line; ellipsis if it overflows */
.ms-Dialog .ms-Dialog-title {
  /* allow wrapping for the title if needed but keep it centered */
  white-space: normal !important;
  overflow: visible !important;
  text-overflow: clip !important;
}

/* Title word styling: make only the 'Emergency' word red */
.ms-Dialog .emergency-title-word {
  color: #ff4d4d !important; /* red, but keep the same font and size as the title */
  margin: 0 !important; /* remove extra spacing so inline spacing is normal */
  font-weight: 700;
  background: transparent !important; /* keep it clean/professional */
  padding: 0 !important;
  display: inline !important;
}

/* Slightly reduce title/body padding for compact appearance */
.ms-Dialog .ms-Dialog-title { padding: 6px 8px !important; }
.ms-Dialog .ms-Dialog-subText { padding: 0 8px 10px 8px !important; }
.ms-Dialog .ms-Dialog-actions { padding: 8px 12px !important; }

/* Make the emergency subtext wrap nicely and not be cut off */
.ms-Dialog .emergency-subtext {
  color: #a6b7c6 !important;
  /* Give the subtext enough width so two lines display naturally */
  max-width: 620px !important;
  /* Force the text to visually occupy at most two lines, then show ellipsis. */
  display: -webkit-box !important;
  line-clamp: 2 !important;
  -webkit-line-clamp: 2 !important; /* limit to two lines */
  -webkit-box-orient: vertical !important;
  overflow: hidden !important; /* hide overflow — no scrollbars */
  text-overflow: ellipsis !important;
  white-space: normal !important;
  word-wrap: break-word !important;
  line-height: 1.35 !important;
  margin-top: 20px !important; /* larger gap between title and subtext (requested) */
}

/* Light-theme overrides for the Create Project dialog */
.light-theme .ms-Dialog.dialog-create-project {
  color: #0b1220; /* dark text */
}
.light-theme .ms-Dialog.dialog-create-project .ms-Dialog-main,
.light-theme .ms-Dialog.dialog-create-project .ms-Dialog-inner,
.light-theme .ms-Dialog.dialog-create-project .ms-Dialog-content {
  background: linear-gradient(180deg, #ffffff, #fbfcff) !important;
  border: 1px solid rgba(16,24,32,0.06) !important;
  color: #0b1220 !important;
}
.light-theme .ms-Dialog.dialog-create-project .ms-Dialog-title {
  color: #0b1220 !important;
}
.light-theme .ms-Dialog.dialog-create-project .ms-Dialog-subText {
  color: #34414a !important;
}
.light-theme .ms-Dialog.dialog-create-project label {
  color: #0b1220 !important;
}
.light-theme .ms-Dialog.dialog-create-project .sleek-select,
.light-theme .ms-Dialog.dialog-create-project select.sleek-select,
.light-theme .ms-Dialog.dialog-create-project .projects-rail-subrow .sleek-select {
  background: #ffffff !important;
  color: #0b1220 !important;
  border: 1px solid rgba(16,24,32,0.08) !important;
  box-shadow: none !important;
}
.light-theme .ms-Dialog.dialog-create-project .sleek-select option,
.light-theme .ms-Dialog.dialog-create-project .sleek-select optgroup {
  background: #ffffff !important;
  color: #0b1220 !important;
}
.light-theme .ms-Dialog.dialog-create-project .ms-Dialog-actions {
  border-top: 1px solid rgba(16,24,32,0.06) !important;
  background: transparent !important;
}
.light-theme .ms-Dialog.dialog-create-project .ms-TextField .ms-TextField-fieldGroup {
  background: #ffffff !important;
  border: 1px solid rgba(16,24,32,0.08) !important;
}
.light-theme .ms-Dialog.dialog-create-project .ms-TextField .ms-TextField-field {
  color: #0b1220 !important;
  background: transparent !important;
}
.light-theme .ms-Dialog.dialog-create-project .ms-TextField .ms-Label {
  color: #0b1220 !important;
}
.light-theme .ms-Dialog.dialog-create-project .ms-Dialog-actions .ms-Button--default {
  border: 1px solid rgba(16,24,32,0.08) !important;
  color: #0b1220 !important;
  background: #f6f8fa !important;
}
.light-theme .ms-Dialog.dialog-create-project .ms-Button--primary,
.light-theme .ms-Dialog.dialog-create-project .ms-Button.accent-cta.ms-Button--primary,
.light-theme .ms-Dialog.dialog-create-project .ms-Dialog .ms-Button--primary {
  /* keep the green accent but ensure contrast on light backgrounds */
  background: linear-gradient(90deg, #39b54a, #1e7f3a) !important;
  color: #ffffff !important;
  box-shadow: 0 6px 16px rgba(30,120,60,0.12) !important;
}

/* ========================= EMERGENCY DIALOG HIGHLIGHT ========================= */
/* (Removed placeholder empty rules to satisfy linter) */

/* === FIBER MAINTENANCE CALENDAR === */
.calendar-panel {
  background: radial-gradient(circle at 30% 20%, #151515, #0f0f0f) !important;
}
.calendar-panel .rbc-calendar {
  background: transparent;
  color: #e6f6ff;
}
.calendar-panel .rbc-toolbar {
  color: #dfefff;
  border: 1px solid #2b2b2b;
  background: linear-gradient(180deg, #101418, #0c1218);
  border-radius: 8px;
  padding: 6px 8px;
  margin-bottom: 8px;
}
.calendar-panel .rbc-toolbar button {
  background: #1a1a1a;
  border: 1px solid #2b2b2b;
  color: #dfefff;
}
.calendar-panel .rbc-toolbar button:hover {
  background: #223;
}
.calendar-panel .rbc-month-view,
.calendar-panel .rbc-time-view {
  border: 1px solid #2b2b2b;
  border-radius: 8px;
}
.calendar-panel .rbc-off-range-bg { background: #0c0c0c; }
.calendar-panel .rbc-today { background: rgba(0,120,212,0.08); }
.calendar-panel .rbc-header {
  background: linear-gradient(90deg, #0078d4, #005a9e);
  color: #fff;
  border-bottom: 1px solid #2b2b2b;
}
.calendar-panel .rbc-date-cell { color: #c9d7e1; }
.calendar-panel .rbc-month-row { border-top: 1px solid #222; }
.calendar-panel .rbc-day-bg + .rbc-day-bg { border-left: 1px solid #222; }
.calendar-panel .rbc-row-segment { padding: 2px 4px; }

/* Event content */
.vso-cal-event .vso-cal-title { color: inherit; }
.vso-cal-pill {
  display: inline-block;
  padding: 1px 6px;
  border-radius: 999px;
  font-size: 10px;
  font-weight: 700;
  letter-spacing: 0.3px;
  text-transform: uppercase;
  border: 1px solid transparent;
}
.vso-cal-pill.status-draft {
  background: rgba(255,193,7,0.18);
  border-color: #cc9900;
  color: #ffdd57;
}
.vso-cal-pill.status-approved {
  background: rgba(0,200,83,0.18);
  border-color: #00cc55;
  color: #a8f3c9;
}
.vso-cal-pill.status-rejected {
  background: rgba(214,55,55,0.18);
  border-color: #cc3333;
  color: #ffb3b3;
}

.calendar-legend .legend-item { display: inline-flex; align-items: center; gap: 6px; }
.calendar-legend .legend-dot { width: 10px; height: 10px; border-radius: 50%; display: inline-block; }
.calendar-legend .legend-dot.draft { background: #cc9900; }
.calendar-legend .legend-dot.approved { background: #00cc55; }
.calendar-legend .legend-dot.rejected { background: #cc3333; }

/* === PANEL CARD (used by AI Summary and Status Tracker) === */
.ai-summary-panel {
  background: radial-gradient(circle at 25% 20%, #161616, #0f0f0f);
  border: 2px solid rgba(80,179,255,0.35);
  border-radius: 12px;
  box-shadow: 0 0 18px rgba(0,0,0,0.5), 0 0 16px rgba(80,179,255,0.22), inset 0 0 10px rgba(255,255,255,0.04);
  color: #dfefff;
  display: flex;
  flex-direction: column;
  min-width: 240px; /* allow shrinking but keep readable */
  max-width: 520px;
  width: 100%;
  box-sizing: border-box;
  height: 140px; /* match capacity circle */
}
.ai-summary-header {
  padding: 8px 12px;
  border-bottom: 1px solid rgba(80,179,255,0.25);
  color: #d2f2ff;
  font-weight: 900;
  font-size: 14px;
  letter-spacing: 0.5px;
  text-shadow: 0 0 8px rgba(80, 179, 255, 0.7);
}
.ai-summary-body { padding: 10px 12px; font-size: 13px; display: flex; flex-direction: column; gap: 6px; justify-content: center; flex: 1 1 auto; overflow: hidden; }
.ai-summary-body b { color: #9bd6ff; font-weight: 700; }

/* Chat-like styling */
.ai-chat { display: flex; flex-direction: column; gap: 8px; }
.ai-chat-bubble {
  background: linear-gradient(180deg, rgba(24,24,24,0.95), rgba(18,18,18,0.95));
  border: 1px solid #2a2a2a;
  border-radius: 10px;
  padding: 10px 12px;
  color: #e9f6ff;
  box-shadow: inset 0 0 8px rgba(255,255,255,0.03);
}
.ai-chat-bubble.loading { color: #9bd6ff; opacity: 0.9; }
.ai-chat-bubble.fallback { color: #d2f7e3; }
.ai-chat-actions { display: flex; align-items: center; gap: 8px; }
.ai-chat-error { color: #ffb3b3; font-size: 11px; }

/* Ensure summary/status cards visually match the circle height */
.ai-summary-panel { min-height: 140px; }

/* === UID TOP INLINE (Summary | Status) — circle sits absolutely to the left === */
.uid-top-inline {
  display: flex;
  justify-content: center; /* center the combined container */
  align-items: center;      /* align with the capacity circle */
  margin-top: 1.25rem;      /* lower the row */
  margin-bottom: 0.75rem;
}
@media (max-width: 900px) {
  .uid-top-inline { padding: 0 8px; }
}

/* === UID TOP ROW: Capacity + AI Summary + Status Tracker === */
.uid-top-row {
  display: flex;
  flex-wrap: wrap;
  gap: 1rem; /* ~16px */
  align-items: stretch;
  margin-bottom: 1rem;
}
.uid-top-row .capacity-tile {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 9rem; /* 144px */
  height: 9rem;
  border-radius: 12px;
  background: radial-gradient(circle at 30% 20%, #151515, #0f0f0f);
  border: 1px solid #2b2b2b;
  box-shadow: 0 6px 20px rgba(0,0,0,0.45), inset 0 0 8px rgba(255,255,255,0.03);
  flex: 0 0 auto;
}
.uid-top-row .panel {
  flex: 1 1 300px; /* grow; min ~300px, wrap on small screens */
  min-width: 260px;
}

/* Equal tables row should wrap on smaller screens */
.equal-tables-row {
  display: flex;
  gap: 20px;
  align-items: stretch;
  width: 100%;
  flex-wrap: wrap; /* allow stacking */
}
.equal-tables-row .table-container {
  flex: 1 1 420px; /* each table prefers ~420px but can shrink */
}

@media (max-width: 768px) {
  .uid-top-row { gap: 0.75rem; }
  .uid-top-row .panel { min-width: 100%; flex-basis: 100%; }
  .uid-top-row .capacity-tile { width: 8.5rem; height: 8.5rem; }
}

/* === Combined AI Summary + Status (single container with two inner subpanels) === */
.combined-horizontal {
  /* centered card with glow */
  background: radial-gradient(circle at 25% 20%, #161616, #0f0f0f);
  border: 2px solid rgba(80,179,255,0.28);
  border-radius: 14px;
  box-shadow: 0 0 18px rgba(0,0,0,0.5), 0 0 16px rgba(80,179,255,0.22), inset 0 0 10px rgba(255,255,255,0.04);
  padding: 12px 14px;
  max-width: 1200px; /* make it longer/wider */
  width: 100%;
  margin: 0 auto 12px;
}
.combined-horizontal .combined-inner {
  display: flex;
  gap: 16px;
  align-items: stretch;
}
.combined-horizontal .ai-summary-subpanel {
  flex: 1 1 0;
  min-width: 320px;
  min-height: 160px; /* a bit taller for better fit */
  display: flex;
  flex-direction: column;
}
@media (max-width: 900px) {
  .combined-horizontal .combined-inner { flex-direction: column; }
}

/* Project Type badge next to project and in cards */
.proj-type-badge {
  display: inline-block;
  padding: 2px 8px;
  border-radius: 999px;
  font-size: 11px;
  font-weight: 800;
  letter-spacing: 0.25px;
  text-transform: none;
  border: 1px solid rgba(120, 140, 170, 0.35);
  background: linear-gradient(180deg, #151515, #0f0f0f);
  color: #dfefff;
}
.proj-type-badge.standard {
  border-color: rgba(120, 140, 170, 0.35);
  color: #cfe7ff;
}
.proj-type-badge.owned {
  border-color: rgba(0, 204, 95, 0.45);
  color: #a8f3c9;
  background: radial-gradient(circle at 30% 20%, rgba(10,25,16,0.95), rgba(8,16,12,0.95));
}
.proj-type-badge.hybrid {
  border-color: rgba(180, 120, 255, 0.45);
  color: #e3c9ff;
  background: radial-gradient(circle at 30% 20%, rgba(22,14,32,0.95), rgba(16,10,24,0.95));
}

/* === THEMED PROGRESS BAR (UID Lookup loading) === */
.themed-progress {
  display: block;
  width: min(680px, 90%);
  margin: 8px auto 12px;
  text-align: left;
}
.themed-progress-track {
  position: relative;
  width: 100%;
  height: 12px;
  border-radius: 999px;
  background: linear-gradient(180deg, #0f1520, #0b1118);
  border: 1px solid rgba(80,140,200,0.25);
  box-shadow: inset 0 2px 6px rgba(0,0,0,0.6), 0 4px 12px rgba(0,0,0,0.35);
  overflow: hidden;
}
.themed-progress-bar {
  position: relative;
  height: 100%;
  border-radius: inherit;
  background: linear-gradient(90deg, #0078d4, #00aaff);
  box-shadow: 0 0 14px rgba(0,120,212,0.45), 0 0 28px rgba(0,120,212,0.30);
  transition: width 280ms ease-out;
}
/* subtle moving sheen */
.themed-progress-bar::after {
  content: "";
  position: absolute;
  top: 0;
  left: -30%;
  width: 30%;
  height: 100%;
  background: linear-gradient(90deg, transparent, rgba(255,255,255,0.25), transparent);
  filter: blur(2px);
  animation: progressSheen 1.6s linear infinite;
}
@keyframes progressSheen {
  0% { left: -30%; }
  100% { left: 100%; }
}
.themed-progress-label {
  margin-top: 6px;
  font-size: 12px;
  color: #a6b7c6;
  text-align: center;
}

/* Light theme variant for UID fetching bar */
.light-theme .themed-progress-track {
  background: linear-gradient(180deg, #e5edf7, #dde7f5);
  border-color: #c3daf4;
}

.light-theme .themed-progress-bar {
  background: linear-gradient(90deg, #0078d4, #00aaff);
  box-shadow: 0 0 10px rgba(0,120,212,0.35), 0 0 20px rgba(0,120,212,0.25);
}

.light-theme .themed-progress-label {
  color: #12355a;
}
